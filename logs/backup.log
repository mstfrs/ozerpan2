Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7a0123eb9120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a012330c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a012330c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a012330c430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a012330c3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a012330c430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a012330c430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7a012330c4c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7a0123d9f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7a0123de3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7a012330c550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7a0123d52830>, <class 'int'>: <function escape_int at 0x7a0123d528c0>, <class 'float'>: <function escape_float at 0x7a0123d52950>, <class 'str'>: <function escape_str at 0x7a0123d52b90>, <class 'bytes'>: <function escape_bytes at 0x7a0123d52b00>, <class 'tuple'>: <function escape_sequence at 0x7a0123d52710>, <class 'list'>: <function escape_sequence at 0x7a0123d52710>, <class 'set'>: <function escape_sequence at 0x7a0123d52710>, <class 'frozenset'>: <function escape_sequence at 0x7a0123d52710>, <class 'dict'>: <function escape_dict at 0x7a0123d52680>, <class 'NoneType'>: <function escape_None at 0x7a0123d52c20>, <class 'datetime.date'>: <function escape_date at 0x7a0123d52e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7a0123d52dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7a0123d52cb0>, <class 'datetime.time'>: <function escape_time at 0x7a0123d52d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7a012330c550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7a012330c550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xb3\'V\xea\x0b\xe4\xff"\xc4\x7fO\x8a\x8e\x16\x89h\xbfr\xb7\xee_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575389'
      authresp = b'\xb3\'V\xea\x0b\xe4\xff"\xc4\x7fO\x8a\x8e\x16\x89h\xbfr\xb7\xee'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575389'
      k = b'_pid'
      v = b'75389'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7a012330c550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7a012330cac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7a012330cac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7a0123eb9120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a0123dbee60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a0123dbee60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a0123dbf460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a0123dbee60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a0123dbf460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a0123dbf460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a012330c3a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7a012330c9d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7a0123d9f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7a0123de3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a012330c3a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a012330c3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a012330c3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a012330c3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a012330c3a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7a012330ca90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7a0123d52830>, <class 'int'>: <function escape_int at 0x7a0123d528c0>, <class 'float'>: <function escape_float at 0x7a0123d52950>, <class 'str'>: <function escape_str at 0x7a0123d52b90>, <class 'bytes'>: <function escape_bytes at 0x7a0123d52b00>, <class 'tuple'>: <function escape_sequence at 0x7a0123d52710>, <class 'list'>: <function escape_sequence at 0x7a0123d52710>, <class 'set'>: <function escape_sequence at 0x7a0123d52710>, <class 'frozenset'>: <function escape_sequence at 0x7a0123d52710>, <class 'dict'>: <function escape_dict at 0x7a0123d52680>, <class 'NoneType'>: <function escape_None at 0x7a0123d52c20>, <class 'datetime.date'>: <function escape_date at 0x7a0123d52e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7a0123d52dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7a0123d52cb0>, <class 'datetime.time'>: <function escape_time at 0x7a0123d52d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7a012330ca90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7a012330ca90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14]\xfcK*[t\x0b?\x02}D\x94\x9c\xd6\x047n\x8b\xd0\x99_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575389'
      authresp = b']\xfcK*[t\x0b?\x02}D\x94\x9c\xd6\x047n\x8b\xd0\x99'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575389'
      k = b'_pid'
      v = b'75389'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7a012330ca90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7a012330e440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7a012330e440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7a0123eb9120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a012330c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a012330c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a012330c4c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a012330c3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a012330c4c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a012330c4c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7a012330e4d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7a0123d9f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7a0123de3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a0123dbee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7a012330e440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7a0123d52830>, <class 'int'>: <function escape_int at 0x7a0123d528c0>, <class 'float'>: <function escape_float at 0x7a0123d52950>, <class 'str'>: <function escape_str at 0x7a0123d52b90>, <class 'bytes'>: <function escape_bytes at 0x7a0123d52b00>, <class 'tuple'>: <function escape_sequence at 0x7a0123d52710>, <class 'list'>: <function escape_sequence at 0x7a0123d52710>, <class 'set'>: <function escape_sequence at 0x7a0123d52710>, <class 'frozenset'>: <function escape_sequence at 0x7a0123d52710>, <class 'dict'>: <function escape_dict at 0x7a0123d52680>, <class 'NoneType'>: <function escape_None at 0x7a0123d52c20>, <class 'datetime.date'>: <function escape_date at 0x7a0123d52e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7a0123d52dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7a0123d52cb0>, <class 'datetime.time'>: <function escape_time at 0x7a0123d52d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7a012330e440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7a012330e440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x147\xe5\xce\xb1\x9b\x14&\x8b\rH\xcb@\xda\xab\xff\x91\xf6\xa0\xdf\xf7_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575389'
      authresp = b'7\xe5\xce\xb1\x9b\x14&\x8b\rH\xcb@\xda\xab\xff\x91\xf6\xa0\xdf\xf7'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575389'
      k = b'_pid'
      v = b'75389'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7a012330e440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7a012330e4a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7a012330e4a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x72e95d4b5120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x72e95c9083a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x72e95c9083a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x72e95c908430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x72e95c9083a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x72e95c908430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x72e95c908430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x72e95c9084c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x72e95d39b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x72e95d3df880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x72e95c908550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x72e95d34e830>, <class 'int'>: <function escape_int at 0x72e95d34e8c0>, <class 'float'>: <function escape_float at 0x72e95d34e950>, <class 'str'>: <function escape_str at 0x72e95d34eb90>, <class 'bytes'>: <function escape_bytes at 0x72e95d34eb00>, <class 'tuple'>: <function escape_sequence at 0x72e95d34e710>, <class 'list'>: <function escape_sequence at 0x72e95d34e710>, <class 'set'>: <function escape_sequence at 0x72e95d34e710>, <class 'frozenset'>: <function escape_sequence at 0x72e95d34e710>, <class 'dict'>: <function escape_dict at 0x72e95d34e680>, <class 'NoneType'>: <function escape_None at 0x72e95d34ec20>, <class 'datetime.date'>: <function escape_date at 0x72e95d34ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x72e95d34edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x72e95d34ecb0>, <class 'datetime.time'>: <function escape_time at 0x72e95d34ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x72e95c908550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x72e95c908550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x9d7\xff\xcf\xce\x92KA\xa8\x1d\xbc\x18\xb5\xca\xd2;5[Mf_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0593425'
      authresp = b'\x9d7\xff\xcf\xce\x92KA\xa8\x1d\xbc\x18\xb5\xca\xd2;5[Mf'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0593425'
      k = b'_pid'
      v = b'93425'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x72e95c908550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x72e95c908ac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x72e95c908ac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x72e95d4b5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x72e95d3bae60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x72e95d3bae60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x72e95d3bb460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x72e95d3bae60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x72e95d3bb460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x72e95d3bb460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95c9083a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x72e95c9089d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x72e95d39b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x72e95d3df880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95c9083a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95c9083a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95c9083a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95c9083a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95c9083a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x72e95c908a90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x72e95d34e830>, <class 'int'>: <function escape_int at 0x72e95d34e8c0>, <class 'float'>: <function escape_float at 0x72e95d34e950>, <class 'str'>: <function escape_str at 0x72e95d34eb90>, <class 'bytes'>: <function escape_bytes at 0x72e95d34eb00>, <class 'tuple'>: <function escape_sequence at 0x72e95d34e710>, <class 'list'>: <function escape_sequence at 0x72e95d34e710>, <class 'set'>: <function escape_sequence at 0x72e95d34e710>, <class 'frozenset'>: <function escape_sequence at 0x72e95d34e710>, <class 'dict'>: <function escape_dict at 0x72e95d34e680>, <class 'NoneType'>: <function escape_None at 0x72e95d34ec20>, <class 'datetime.date'>: <function escape_date at 0x72e95d34ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x72e95d34edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x72e95d34ecb0>, <class 'datetime.time'>: <function escape_time at 0x72e95d34ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x72e95c908a90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x72e95c908a90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xce\x050@a6\xfb\xedPhwGS\n"..^\x00\xf1_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0593425'
      authresp = b'\xce\x050@a6\xfb\xedPhwGS\n"..^\x00\xf1'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0593425'
      k = b'_pid'
      v = b'93425'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x72e95c908a90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x72e95c90a440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x72e95c90a440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x72e95d4b5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x72e95c9083a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x72e95c9083a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x72e95c9084c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x72e95c9083a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x72e95c9084c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x72e95c9084c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x72e95c90a4d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x72e95d39b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x72e95d3df880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x72e95d3bae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x72e95c90a440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x72e95d34e830>, <class 'int'>: <function escape_int at 0x72e95d34e8c0>, <class 'float'>: <function escape_float at 0x72e95d34e950>, <class 'str'>: <function escape_str at 0x72e95d34eb90>, <class 'bytes'>: <function escape_bytes at 0x72e95d34eb00>, <class 'tuple'>: <function escape_sequence at 0x72e95d34e710>, <class 'list'>: <function escape_sequence at 0x72e95d34e710>, <class 'set'>: <function escape_sequence at 0x72e95d34e710>, <class 'frozenset'>: <function escape_sequence at 0x72e95d34e710>, <class 'dict'>: <function escape_dict at 0x72e95d34e680>, <class 'NoneType'>: <function escape_None at 0x72e95d34ec20>, <class 'datetime.date'>: <function escape_date at 0x72e95d34ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x72e95d34edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x72e95d34ecb0>, <class 'datetime.time'>: <function escape_time at 0x72e95d34ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x72e95c90a440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x72e95c90a440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14]\xc2[\x86\xc6%/!\xebA\xf2\x9c\x8e\x023|\x7f\xecq\xeb_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0593425'
      authresp = b']\xc2[\x86\xc6%/!\xebA\xf2\x9c\x8e\x023|\x7f\xecq\xeb'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0593425'
      k = b'_pid'
      v = b'93425'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x72e95c90a440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x72e95c90a4a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x72e95c90a4a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7a607d7c5120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a607cc183a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a607cc183a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a607cc18430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a607cc183a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a607cc18430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a607cc18430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7a607cc184c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7a607cdab640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7a607cdef880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7a607cc18550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7a607cd5e830>, <class 'int'>: <function escape_int at 0x7a607cd5e8c0>, <class 'float'>: <function escape_float at 0x7a607cd5e950>, <class 'str'>: <function escape_str at 0x7a607cd5eb90>, <class 'bytes'>: <function escape_bytes at 0x7a607cd5eb00>, <class 'tuple'>: <function escape_sequence at 0x7a607cd5e710>, <class 'list'>: <function escape_sequence at 0x7a607cd5e710>, <class 'set'>: <function escape_sequence at 0x7a607cd5e710>, <class 'frozenset'>: <function escape_sequence at 0x7a607cd5e710>, <class 'dict'>: <function escape_dict at 0x7a607cd5e680>, <class 'NoneType'>: <function escape_None at 0x7a607cd5ec20>, <class 'datetime.date'>: <function escape_date at 0x7a607cd5ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7a607cd5edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7a607cd5ecb0>, <class 'datetime.time'>: <function escape_time at 0x7a607cd5ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7a607cc18550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7a607cc18550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14<\x0bb\x94\xa5\xce\xf8%\xc7\x9a\x96\x01\xf1G\x9e\x14I\xd5\x00P_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06147102'
      authresp = b'<\x0bb\x94\xa5\xce\xf8%\xc7\x9a\x96\x01\xf1G\x9e\x14I\xd5\x00P'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06147102'
      k = b'_pid'
      v = b'147102'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7a607cc18550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7a607cc18af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7a607cc18af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7a607d7c5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a607cdcae60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a607cdcae60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a607cdcb460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a607cdcae60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a607cdcb460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a607cdcb460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cc183a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7a607cc189d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7a607cdab640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7a607cdef880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cc183a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cc183a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cc183a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cc183a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cc183a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7a607cc18ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7a607cd5e830>, <class 'int'>: <function escape_int at 0x7a607cd5e8c0>, <class 'float'>: <function escape_float at 0x7a607cd5e950>, <class 'str'>: <function escape_str at 0x7a607cd5eb90>, <class 'bytes'>: <function escape_bytes at 0x7a607cd5eb00>, <class 'tuple'>: <function escape_sequence at 0x7a607cd5e710>, <class 'list'>: <function escape_sequence at 0x7a607cd5e710>, <class 'set'>: <function escape_sequence at 0x7a607cd5e710>, <class 'frozenset'>: <function escape_sequence at 0x7a607cd5e710>, <class 'dict'>: <function escape_dict at 0x7a607cd5e680>, <class 'NoneType'>: <function escape_None at 0x7a607cd5ec20>, <class 'datetime.date'>: <function escape_date at 0x7a607cd5ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7a607cd5edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7a607cd5ecb0>, <class 'datetime.time'>: <function escape_time at 0x7a607cd5ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7a607cc18ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7a607cc18ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14I_\xc2\x9e\xdc\x07$\rk\xaad\x99\x93Oo%\x02\xd2\x85\xd8_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06147102'
      authresp = b'I_\xc2\x9e\xdc\x07$\rk\xaad\x99\x93Oo%\x02\xd2\x85\xd8'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06147102'
      k = b'_pid'
      v = b'147102'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7a607cc18ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7a607cc1a470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7a607cc1a470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7a607d7c5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a607cc183a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a607cc183a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a607cc184c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7a607cc183a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a607cc184c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7a607cc184c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7a607cc1a500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7a607cdab640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7a607cdef880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7a607cdcae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7a607cc1a470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7a607cd5e830>, <class 'int'>: <function escape_int at 0x7a607cd5e8c0>, <class 'float'>: <function escape_float at 0x7a607cd5e950>, <class 'str'>: <function escape_str at 0x7a607cd5eb90>, <class 'bytes'>: <function escape_bytes at 0x7a607cd5eb00>, <class 'tuple'>: <function escape_sequence at 0x7a607cd5e710>, <class 'list'>: <function escape_sequence at 0x7a607cd5e710>, <class 'set'>: <function escape_sequence at 0x7a607cd5e710>, <class 'frozenset'>: <function escape_sequence at 0x7a607cd5e710>, <class 'dict'>: <function escape_dict at 0x7a607cd5e680>, <class 'NoneType'>: <function escape_None at 0x7a607cd5ec20>, <class 'datetime.date'>: <function escape_date at 0x7a607cd5ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7a607cd5edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7a607cd5ecb0>, <class 'datetime.time'>: <function escape_time at 0x7a607cd5ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7a607cc1a470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7a607cc1a470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xea:G:\x8a\xfdZ\x80\xcd\x99x\x14\xeaV\xf5i{\x83\xcb\xe4_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06147102'
      authresp = b'\xea:G:\x8a\xfdZ\x80\xcd\x99x\x14\xeaV\xf5i{\x83\xcb\xe4'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06147102'
      k = b'_pid'
      v = b'147102'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7a607cc1a470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7a607cc1a4d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7a607cc1a4d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x798cd7c99120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x798cd7bec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x798cd7bec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x798cd7bec430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x798cd7bec3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x798cd7bec430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x798cd7bec430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x798cd7bec4c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x798cd7b7f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x798cd7bc3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x798cd7bec550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x798cd7b32830>, <class 'int'>: <function escape_int at 0x798cd7b328c0>, <class 'float'>: <function escape_float at 0x798cd7b32950>, <class 'str'>: <function escape_str at 0x798cd7b32b90>, <class 'bytes'>: <function escape_bytes at 0x798cd7b32b00>, <class 'tuple'>: <function escape_sequence at 0x798cd7b32710>, <class 'list'>: <function escape_sequence at 0x798cd7b32710>, <class 'set'>: <function escape_sequence at 0x798cd7b32710>, <class 'frozenset'>: <function escape_sequence at 0x798cd7b32710>, <class 'dict'>: <function escape_dict at 0x798cd7b32680>, <class 'NoneType'>: <function escape_None at 0x798cd7b32c20>, <class 'datetime.date'>: <function escape_date at 0x798cd7b32e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x798cd7b32dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x798cd7b32cb0>, <class 'datetime.time'>: <function escape_time at 0x798cd7b32d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x798cd7bec550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x798cd7bec550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x04(\xba\x94c\x8e\xab\x9d\x84z\xa2c\xc5\xd8\x0e0\xfc`\xb9\x80_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06153714'
      authresp = b'\x04(\xba\x94c\x8e\xab\x9d\x84z\xa2c\xc5\xd8\x0e0\xfc`\xb9\x80'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06153714'
      k = b'_pid'
      v = b'153714'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x798cd7bec550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x798cd7becaf0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x798cd7becaf0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x798cd7c99120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x798cd7b9ee60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x798cd7b9ee60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x798cd7b9f460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x798cd7b9ee60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x798cd7b9f460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x798cd7b9f460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7bec3a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x798cd7bec9d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x798cd7b7f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x798cd7bc3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7bec3a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7bec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7bec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7bec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7bec3a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x798cd7becac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x798cd7b32830>, <class 'int'>: <function escape_int at 0x798cd7b328c0>, <class 'float'>: <function escape_float at 0x798cd7b32950>, <class 'str'>: <function escape_str at 0x798cd7b32b90>, <class 'bytes'>: <function escape_bytes at 0x798cd7b32b00>, <class 'tuple'>: <function escape_sequence at 0x798cd7b32710>, <class 'list'>: <function escape_sequence at 0x798cd7b32710>, <class 'set'>: <function escape_sequence at 0x798cd7b32710>, <class 'frozenset'>: <function escape_sequence at 0x798cd7b32710>, <class 'dict'>: <function escape_dict at 0x798cd7b32680>, <class 'NoneType'>: <function escape_None at 0x798cd7b32c20>, <class 'datetime.date'>: <function escape_date at 0x798cd7b32e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x798cd7b32dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x798cd7b32cb0>, <class 'datetime.time'>: <function escape_time at 0x798cd7b32d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x798cd7becac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x798cd7becac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xdar\xee*\x03\xc8\x02\xba\x1f\xfe<\xfc\x96\x8a\x11\xc5\x0bX\x9eA_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06153714'
      authresp = b'\xdar\xee*\x03\xc8\x02\xba\x1f\xfe<\xfc\x96\x8a\x11\xc5\x0bX\x9eA'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06153714'
      k = b'_pid'
      v = b'153714'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x798cd7becac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x798cd7bee470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x798cd7bee470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x798cd7c99120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x798cd7bec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x798cd7bec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x798cd7bec4c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x798cd7bec3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x798cd7bec4c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x798cd7bec4c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x798cd7bee500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x798cd7b7f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x798cd7bc3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x798cd7b9ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x798cd7bee470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x798cd7b32830>, <class 'int'>: <function escape_int at 0x798cd7b328c0>, <class 'float'>: <function escape_float at 0x798cd7b32950>, <class 'str'>: <function escape_str at 0x798cd7b32b90>, <class 'bytes'>: <function escape_bytes at 0x798cd7b32b00>, <class 'tuple'>: <function escape_sequence at 0x798cd7b32710>, <class 'list'>: <function escape_sequence at 0x798cd7b32710>, <class 'set'>: <function escape_sequence at 0x798cd7b32710>, <class 'frozenset'>: <function escape_sequence at 0x798cd7b32710>, <class 'dict'>: <function escape_dict at 0x798cd7b32680>, <class 'NoneType'>: <function escape_None at 0x798cd7b32c20>, <class 'datetime.date'>: <function escape_date at 0x798cd7b32e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x798cd7b32dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x798cd7b32cb0>, <class 'datetime.time'>: <function escape_time at 0x798cd7b32d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x798cd7bee470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x798cd7bee470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x12\xdf\xce\xd2l\xd2\xff\xc6\x05:}%\x82\xe5;pa\xe2\xf7\xeb_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06153714'
      authresp = b'\x12\xdf\xce\xd2l\xd2\xff\xc6\x05:}%\x82\xe5;pa\xe2\xf7\xeb'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06153714'
      k = b'_pid'
      v = b'153714'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x798cd7bee470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x798cd7bee4d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x798cd7bee4d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7599f79a1120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7599f6ff43a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7599f6ff43a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7599f6ff4430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7599f6ff43a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7599f6ff4430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7599f6ff4430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7599f6ff44c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7599f6f87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7599f6fcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7599f6ff4550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7599f6f3a830>, <class 'int'>: <function escape_int at 0x7599f6f3a8c0>, <class 'float'>: <function escape_float at 0x7599f6f3a950>, <class 'str'>: <function escape_str at 0x7599f6f3ab90>, <class 'bytes'>: <function escape_bytes at 0x7599f6f3ab00>, <class 'tuple'>: <function escape_sequence at 0x7599f6f3a710>, <class 'list'>: <function escape_sequence at 0x7599f6f3a710>, <class 'set'>: <function escape_sequence at 0x7599f6f3a710>, <class 'frozenset'>: <function escape_sequence at 0x7599f6f3a710>, <class 'dict'>: <function escape_dict at 0x7599f6f3a680>, <class 'NoneType'>: <function escape_None at 0x7599f6f3ac20>, <class 'datetime.date'>: <function escape_date at 0x7599f6f3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7599f6f3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7599f6f3acb0>, <class 'datetime.time'>: <function escape_time at 0x7599f6f3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7599f6ff4550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7599f6ff4550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14i[\x84\x84tY\xbej\x0e:r}\xd3Z=vo.\x85e_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06159356'
      authresp = b'i[\x84\x84tY\xbej\x0e:r}\xd3Z=vo.\x85e'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06159356'
      k = b'_pid'
      v = b'159356'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7599f6ff4550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7599f6ff4af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7599f6ff4af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7599f79a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7599f6fa6e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7599f6fa6e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7599f6fa7460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7599f6fa6e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7599f6fa7460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7599f6fa7460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6ff43a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7599f6ff49d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7599f6f87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7599f6fcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6ff43a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6ff43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6ff43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6ff43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6ff43a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7599f6ff4ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7599f6f3a830>, <class 'int'>: <function escape_int at 0x7599f6f3a8c0>, <class 'float'>: <function escape_float at 0x7599f6f3a950>, <class 'str'>: <function escape_str at 0x7599f6f3ab90>, <class 'bytes'>: <function escape_bytes at 0x7599f6f3ab00>, <class 'tuple'>: <function escape_sequence at 0x7599f6f3a710>, <class 'list'>: <function escape_sequence at 0x7599f6f3a710>, <class 'set'>: <function escape_sequence at 0x7599f6f3a710>, <class 'frozenset'>: <function escape_sequence at 0x7599f6f3a710>, <class 'dict'>: <function escape_dict at 0x7599f6f3a680>, <class 'NoneType'>: <function escape_None at 0x7599f6f3ac20>, <class 'datetime.date'>: <function escape_date at 0x7599f6f3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7599f6f3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7599f6f3acb0>, <class 'datetime.time'>: <function escape_time at 0x7599f6f3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7599f6ff4ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7599f6ff4ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14r\xecd\x85\x1a- \xf7e\xa3\xb6\xa1\xf0\xef\x8e\x90{\xc1\x82\x96_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06159356'
      authresp = b'r\xecd\x85\x1a- \xf7e\xa3\xb6\xa1\xf0\xef\x8e\x90{\xc1\x82\x96'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06159356'
      k = b'_pid'
      v = b'159356'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7599f6ff4ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7599f6ff6470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7599f6ff6470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7599f79a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7599f6ff43a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7599f6ff43a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7599f6ff44c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7599f6ff43a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7599f6ff44c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7599f6ff44c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7599f6ff6500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7599f6f87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7599f6fcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7599f6fa6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7599f6ff6470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7599f6f3a830>, <class 'int'>: <function escape_int at 0x7599f6f3a8c0>, <class 'float'>: <function escape_float at 0x7599f6f3a950>, <class 'str'>: <function escape_str at 0x7599f6f3ab90>, <class 'bytes'>: <function escape_bytes at 0x7599f6f3ab00>, <class 'tuple'>: <function escape_sequence at 0x7599f6f3a710>, <class 'list'>: <function escape_sequence at 0x7599f6f3a710>, <class 'set'>: <function escape_sequence at 0x7599f6f3a710>, <class 'frozenset'>: <function escape_sequence at 0x7599f6f3a710>, <class 'dict'>: <function escape_dict at 0x7599f6f3a680>, <class 'NoneType'>: <function escape_None at 0x7599f6f3ac20>, <class 'datetime.date'>: <function escape_date at 0x7599f6f3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7599f6f3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7599f6f3acb0>, <class 'datetime.time'>: <function escape_time at 0x7599f6f3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7599f6ff6470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7599f6ff6470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xe5\xd3#(I~\xa0\x10\n\xee\xa7S n\xbc&\x1e\x93\x11\x85_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06159356'
      authresp = b'\xe5\xd3#(I~\xa0\x10\n\xee\xa7S n\xbc&\x1e\x93\x11\x85'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06159356'
      k = b'_pid'
      v = b'159356'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7599f6ff6470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7599f6ff64d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7599f6ff64d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7583053a1120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7583049f43a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7583049f43a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7583049f4430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7583049f43a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7583049f4430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7583049f4430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7583049f44c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x758304987640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7583049cb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7583049f4550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x75830493a830>, <class 'int'>: <function escape_int at 0x75830493a8c0>, <class 'float'>: <function escape_float at 0x75830493a950>, <class 'str'>: <function escape_str at 0x75830493ab90>, <class 'bytes'>: <function escape_bytes at 0x75830493ab00>, <class 'tuple'>: <function escape_sequence at 0x75830493a710>, <class 'list'>: <function escape_sequence at 0x75830493a710>, <class 'set'>: <function escape_sequence at 0x75830493a710>, <class 'frozenset'>: <function escape_sequence at 0x75830493a710>, <class 'dict'>: <function escape_dict at 0x75830493a680>, <class 'NoneType'>: <function escape_None at 0x75830493ac20>, <class 'datetime.date'>: <function escape_date at 0x75830493ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x75830493add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x75830493acb0>, <class 'datetime.time'>: <function escape_time at 0x75830493ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7583049f4550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7583049f4550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14k\xc8]\xc5\xa9\xcb\x1az\x8cm\xb4u\x8a\xc2v\xee\xee\x04z\xb9_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06165165'
      authresp = b'k\xc8]\xc5\xa9\xcb\x1az\x8cm\xb4u\x8a\xc2v\xee\xee\x04z\xb9'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06165165'
      k = b'_pid'
      v = b'165165'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7583049f4550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7583049f4af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7583049f4af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7583053a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7583049a6e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7583049a6e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7583049a7460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7583049a6e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7583049a7460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7583049a7460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049f43a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7583049f49d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x758304987640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7583049cb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049f43a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049f43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049f43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049f43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049f43a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7583049f4ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x75830493a830>, <class 'int'>: <function escape_int at 0x75830493a8c0>, <class 'float'>: <function escape_float at 0x75830493a950>, <class 'str'>: <function escape_str at 0x75830493ab90>, <class 'bytes'>: <function escape_bytes at 0x75830493ab00>, <class 'tuple'>: <function escape_sequence at 0x75830493a710>, <class 'list'>: <function escape_sequence at 0x75830493a710>, <class 'set'>: <function escape_sequence at 0x75830493a710>, <class 'frozenset'>: <function escape_sequence at 0x75830493a710>, <class 'dict'>: <function escape_dict at 0x75830493a680>, <class 'NoneType'>: <function escape_None at 0x75830493ac20>, <class 'datetime.date'>: <function escape_date at 0x75830493ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x75830493add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x75830493acb0>, <class 'datetime.time'>: <function escape_time at 0x75830493ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7583049f4ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7583049f4ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x9dr\r\xb2\xda\xd1&+\x9c\xd6\xae_\x91g)\x0e,\xe5\xaf-_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06165165'
      authresp = b'\x9dr\r\xb2\xda\xd1&+\x9c\xd6\xae_\x91g)\x0e,\xe5\xaf-'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06165165'
      k = b'_pid'
      v = b'165165'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7583049f4ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7583049f6470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7583049f6470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7583053a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7583049f43a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7583049f43a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7583049f44c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7583049f43a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7583049f44c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7583049f44c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7583049f6500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x758304987640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7583049cb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7583049a6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7583049f6470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x75830493a830>, <class 'int'>: <function escape_int at 0x75830493a8c0>, <class 'float'>: <function escape_float at 0x75830493a950>, <class 'str'>: <function escape_str at 0x75830493ab90>, <class 'bytes'>: <function escape_bytes at 0x75830493ab00>, <class 'tuple'>: <function escape_sequence at 0x75830493a710>, <class 'list'>: <function escape_sequence at 0x75830493a710>, <class 'set'>: <function escape_sequence at 0x75830493a710>, <class 'frozenset'>: <function escape_sequence at 0x75830493a710>, <class 'dict'>: <function escape_dict at 0x75830493a680>, <class 'NoneType'>: <function escape_None at 0x75830493ac20>, <class 'datetime.date'>: <function escape_date at 0x75830493ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x75830493add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x75830493acb0>, <class 'datetime.time'>: <function escape_time at 0x75830493ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7583049f6470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7583049f6470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14mY^\xffe\xd3\xd5\xfc \xc2Q\xa2C\xa5\x99\xa9"\x8f\x9f\xff_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06165165'
      authresp = b'mY^\xffe\xd3\xd5\xfc \xc2Q\xa2C\xa5\x99\xa9"\x8f\x9f\xff'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06165165'
      k = b'_pid'
      v = b'165165'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7583049f6470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7583049f64d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7583049f64d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x784d19ac5120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x784d18f183a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x784d18f183a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x784d18f18430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x784d18f183a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x784d18f18430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x784d18f18430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x784d18f184c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x784d199ab640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x784d199ef880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x784d18f18550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x784d1995e830>, <class 'int'>: <function escape_int at 0x784d1995e8c0>, <class 'float'>: <function escape_float at 0x784d1995e950>, <class 'str'>: <function escape_str at 0x784d1995eb90>, <class 'bytes'>: <function escape_bytes at 0x784d1995eb00>, <class 'tuple'>: <function escape_sequence at 0x784d1995e710>, <class 'list'>: <function escape_sequence at 0x784d1995e710>, <class 'set'>: <function escape_sequence at 0x784d1995e710>, <class 'frozenset'>: <function escape_sequence at 0x784d1995e710>, <class 'dict'>: <function escape_dict at 0x784d1995e680>, <class 'NoneType'>: <function escape_None at 0x784d1995ec20>, <class 'datetime.date'>: <function escape_date at 0x784d1995ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x784d1995edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x784d1995ecb0>, <class 'datetime.time'>: <function escape_time at 0x784d1995ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x784d18f18550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x784d18f18550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14[O\x94,\xebBg\xafB\xe1\xa98w\xc2\xea\x96a\x11w\xde_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06175987'
      authresp = b'[O\x94,\xebBg\xafB\xe1\xa98w\xc2\xea\x96a\x11w\xde'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06175987'
      k = b'_pid'
      v = b'175987'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x784d18f18550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x784d18f18af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x784d18f18af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x784d19ac5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x784d199cae60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x784d199cae60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x784d199cb460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x784d199cae60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x784d199cb460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x784d199cb460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d18f183a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x784d18f189d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x784d199ab640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x784d199ef880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d18f183a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d18f183a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d18f183a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d18f183a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d18f183a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x784d18f18ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x784d1995e830>, <class 'int'>: <function escape_int at 0x784d1995e8c0>, <class 'float'>: <function escape_float at 0x784d1995e950>, <class 'str'>: <function escape_str at 0x784d1995eb90>, <class 'bytes'>: <function escape_bytes at 0x784d1995eb00>, <class 'tuple'>: <function escape_sequence at 0x784d1995e710>, <class 'list'>: <function escape_sequence at 0x784d1995e710>, <class 'set'>: <function escape_sequence at 0x784d1995e710>, <class 'frozenset'>: <function escape_sequence at 0x784d1995e710>, <class 'dict'>: <function escape_dict at 0x784d1995e680>, <class 'NoneType'>: <function escape_None at 0x784d1995ec20>, <class 'datetime.date'>: <function escape_date at 0x784d1995ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x784d1995edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x784d1995ecb0>, <class 'datetime.time'>: <function escape_time at 0x784d1995ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x784d18f18ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x784d18f18ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14.\xda\xa4\xc7\x89\x1bj\xfew\xc15"\x1d\xa6\xc6%\xf5\x86NL_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06175987'
      authresp = b'.\xda\xa4\xc7\x89\x1bj\xfew\xc15"\x1d\xa6\xc6%\xf5\x86NL'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06175987'
      k = b'_pid'
      v = b'175987'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x784d18f18ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x784d18f1a470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x784d18f1a470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x784d19ac5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x784d18f183a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x784d18f183a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x784d18f184c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x784d18f183a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x784d18f184c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x784d18f184c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x784d18f1a500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x784d199ab640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x784d199ef880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x784d199cae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x784d18f1a470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x784d1995e830>, <class 'int'>: <function escape_int at 0x784d1995e8c0>, <class 'float'>: <function escape_float at 0x784d1995e950>, <class 'str'>: <function escape_str at 0x784d1995eb90>, <class 'bytes'>: <function escape_bytes at 0x784d1995eb00>, <class 'tuple'>: <function escape_sequence at 0x784d1995e710>, <class 'list'>: <function escape_sequence at 0x784d1995e710>, <class 'set'>: <function escape_sequence at 0x784d1995e710>, <class 'frozenset'>: <function escape_sequence at 0x784d1995e710>, <class 'dict'>: <function escape_dict at 0x784d1995e680>, <class 'NoneType'>: <function escape_None at 0x784d1995ec20>, <class 'datetime.date'>: <function escape_date at 0x784d1995ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x784d1995edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x784d1995ecb0>, <class 'datetime.time'>: <function escape_time at 0x784d1995ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x784d18f1a470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x784d18f1a470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14>tu\xf5\x0fO\x83\xdf*\xea/U\x93\xce\x99\xf5\xf8n~\x03_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06175987'
      authresp = b'>tu\xf5\x0fO\x83\xdf*\xea/U\x93\xce\x99\xf5\xf8n~\x03'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06175987'
      k = b'_pid'
      v = b'175987'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x784d18f1a470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x784d18f1a4d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x784d18f1a4d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7ede0f2b9120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ede0e70c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ede0e70c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ede0e70c430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ede0e70c3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ede0e70c430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ede0e70c430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7ede0e70c4c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7ede0f19f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7ede0f1e3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7ede0e70c550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7ede0f152830>, <class 'int'>: <function escape_int at 0x7ede0f1528c0>, <class 'float'>: <function escape_float at 0x7ede0f152950>, <class 'str'>: <function escape_str at 0x7ede0f152b90>, <class 'bytes'>: <function escape_bytes at 0x7ede0f152b00>, <class 'tuple'>: <function escape_sequence at 0x7ede0f152710>, <class 'list'>: <function escape_sequence at 0x7ede0f152710>, <class 'set'>: <function escape_sequence at 0x7ede0f152710>, <class 'frozenset'>: <function escape_sequence at 0x7ede0f152710>, <class 'dict'>: <function escape_dict at 0x7ede0f152680>, <class 'NoneType'>: <function escape_None at 0x7ede0f152c20>, <class 'datetime.date'>: <function escape_date at 0x7ede0f152e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7ede0f152dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7ede0f152cb0>, <class 'datetime.time'>: <function escape_time at 0x7ede0f152d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7ede0e70c550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7ede0e70c550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x8b\x01\x07\xed\xaeIq~Uk\x0f\xca4v|\x1bKcN0_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0532290'
      authresp = b'\x8b\x01\x07\xed\xaeIq~Uk\x0f\xca4v|\x1bKcN0'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0532290'
      k = b'_pid'
      v = b'32290'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7ede0e70c550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7ede0e70cac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7ede0e70cac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7ede0f2b9120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ede0f1bee60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ede0f1bee60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ede0f1bf460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ede0f1bee60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ede0f1bf460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ede0f1bf460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0e70c3a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7ede0e70c9d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7ede0f19f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7ede0f1e3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0e70c3a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0e70c3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0e70c3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0e70c3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0e70c3a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7ede0e70ca90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7ede0f152830>, <class 'int'>: <function escape_int at 0x7ede0f1528c0>, <class 'float'>: <function escape_float at 0x7ede0f152950>, <class 'str'>: <function escape_str at 0x7ede0f152b90>, <class 'bytes'>: <function escape_bytes at 0x7ede0f152b00>, <class 'tuple'>: <function escape_sequence at 0x7ede0f152710>, <class 'list'>: <function escape_sequence at 0x7ede0f152710>, <class 'set'>: <function escape_sequence at 0x7ede0f152710>, <class 'frozenset'>: <function escape_sequence at 0x7ede0f152710>, <class 'dict'>: <function escape_dict at 0x7ede0f152680>, <class 'NoneType'>: <function escape_None at 0x7ede0f152c20>, <class 'datetime.date'>: <function escape_date at 0x7ede0f152e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7ede0f152dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7ede0f152cb0>, <class 'datetime.time'>: <function escape_time at 0x7ede0f152d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7ede0e70ca90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7ede0e70ca90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14?\xb6\xc9\xec\x96\x8d\x0b\xb8\xa1\xce\xa7\x7f\xd1\x85\t\x1eH\x18c-_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0532290'
      authresp = b'?\xb6\xc9\xec\x96\x8d\x0b\xb8\xa1\xce\xa7\x7f\xd1\x85\t\x1eH\x18c-'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0532290'
      k = b'_pid'
      v = b'32290'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7ede0e70ca90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7ede0e70e440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7ede0e70e440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7ede0f2b9120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ede0e70c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ede0e70c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ede0e70c4c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7ede0e70c3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ede0e70c4c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7ede0e70c4c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7ede0e70e4d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7ede0f19f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7ede0f1e3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7ede0f1bee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7ede0e70e440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7ede0f152830>, <class 'int'>: <function escape_int at 0x7ede0f1528c0>, <class 'float'>: <function escape_float at 0x7ede0f152950>, <class 'str'>: <function escape_str at 0x7ede0f152b90>, <class 'bytes'>: <function escape_bytes at 0x7ede0f152b00>, <class 'tuple'>: <function escape_sequence at 0x7ede0f152710>, <class 'list'>: <function escape_sequence at 0x7ede0f152710>, <class 'set'>: <function escape_sequence at 0x7ede0f152710>, <class 'frozenset'>: <function escape_sequence at 0x7ede0f152710>, <class 'dict'>: <function escape_dict at 0x7ede0f152680>, <class 'NoneType'>: <function escape_None at 0x7ede0f152c20>, <class 'datetime.date'>: <function escape_date at 0x7ede0f152e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7ede0f152dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7ede0f152cb0>, <class 'datetime.time'>: <function escape_time at 0x7ede0f152d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7ede0e70e440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7ede0e70e440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xa4_8\x90\xc3\x81L\xd3\xf3\xd4\xed\x10`~\x10H\x97\xaa\x1c\x05_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0532290'
      authresp = b'\xa4_8\x90\xc3\x81L\xd3\xf3\xd4\xed\x10`~\x10H\x97\xaa\x1c\x05'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0532290'
      k = b'_pid'
      v = b'32290'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7ede0e70e440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7ede0e70e4a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7ede0e70e4a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7059195a1120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x705918bf43a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x705918bf43a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x705918bf4430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x705918bf43a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x705918bf4430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x705918bf4430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x705918bf44c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x705918b87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x705918bcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x705918bf4550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x705918b3a830>, <class 'int'>: <function escape_int at 0x705918b3a8c0>, <class 'float'>: <function escape_float at 0x705918b3a950>, <class 'str'>: <function escape_str at 0x705918b3ab90>, <class 'bytes'>: <function escape_bytes at 0x705918b3ab00>, <class 'tuple'>: <function escape_sequence at 0x705918b3a710>, <class 'list'>: <function escape_sequence at 0x705918b3a710>, <class 'set'>: <function escape_sequence at 0x705918b3a710>, <class 'frozenset'>: <function escape_sequence at 0x705918b3a710>, <class 'dict'>: <function escape_dict at 0x705918b3a680>, <class 'NoneType'>: <function escape_None at 0x705918b3ac20>, <class 'datetime.date'>: <function escape_date at 0x705918b3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x705918b3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x705918b3acb0>, <class 'datetime.time'>: <function escape_time at 0x705918b3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x705918bf4550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x705918bf4550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x057G\x9f\xbb\x0bZ\r\xa6 "\x1c\x86\xb0\xef\x06\xf1\xf9\xa4\xe5_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575787'
      authresp = b'\x057G\x9f\xbb\x0bZ\r\xa6 "\x1c\x86\xb0\xef\x06\xf1\xf9\xa4\xe5'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575787'
      k = b'_pid'
      v = b'75787'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x705918bf4550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x705918bf4ac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x705918bf4ac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7059195a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x705918ba6e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x705918ba6e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x705918ba7460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x705918ba6e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x705918ba7460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x705918ba7460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918bf43a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x705918bf49d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x705918b87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x705918bcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918bf43a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918bf43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918bf43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918bf43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918bf43a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x705918bf4a90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x705918b3a830>, <class 'int'>: <function escape_int at 0x705918b3a8c0>, <class 'float'>: <function escape_float at 0x705918b3a950>, <class 'str'>: <function escape_str at 0x705918b3ab90>, <class 'bytes'>: <function escape_bytes at 0x705918b3ab00>, <class 'tuple'>: <function escape_sequence at 0x705918b3a710>, <class 'list'>: <function escape_sequence at 0x705918b3a710>, <class 'set'>: <function escape_sequence at 0x705918b3a710>, <class 'frozenset'>: <function escape_sequence at 0x705918b3a710>, <class 'dict'>: <function escape_dict at 0x705918b3a680>, <class 'NoneType'>: <function escape_None at 0x705918b3ac20>, <class 'datetime.date'>: <function escape_date at 0x705918b3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x705918b3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x705918b3acb0>, <class 'datetime.time'>: <function escape_time at 0x705918b3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x705918bf4a90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x705918bf4a90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xde\x80\xb2\xa8k\x988\xb1\x7f*\xb9L\xa0>\xa2G1\xdf\x839_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575787'
      authresp = b'\xde\x80\xb2\xa8k\x988\xb1\x7f*\xb9L\xa0>\xa2G1\xdf\x839'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575787'
      k = b'_pid'
      v = b'75787'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x705918bf4a90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x705918bf6440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x705918bf6440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7059195a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x705918bf43a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x705918bf43a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x705918bf44c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x705918bf43a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x705918bf44c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x705918bf44c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x705918bf64d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x705918b87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x705918bcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x705918ba6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x705918bf6440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x705918b3a830>, <class 'int'>: <function escape_int at 0x705918b3a8c0>, <class 'float'>: <function escape_float at 0x705918b3a950>, <class 'str'>: <function escape_str at 0x705918b3ab90>, <class 'bytes'>: <function escape_bytes at 0x705918b3ab00>, <class 'tuple'>: <function escape_sequence at 0x705918b3a710>, <class 'list'>: <function escape_sequence at 0x705918b3a710>, <class 'set'>: <function escape_sequence at 0x705918b3a710>, <class 'frozenset'>: <function escape_sequence at 0x705918b3a710>, <class 'dict'>: <function escape_dict at 0x705918b3a680>, <class 'NoneType'>: <function escape_None at 0x705918b3ac20>, <class 'datetime.date'>: <function escape_date at 0x705918b3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x705918b3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x705918b3acb0>, <class 'datetime.time'>: <function escape_time at 0x705918b3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x705918bf6440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x705918bf6440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xbeN-\xb2)D\xb7\x89l\xc5\xa0\xb6\x02\xb9\n\xc8\xeb\xca\x06\xd0_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575787'
      authresp = b'\xbeN-\xb2)D\xb7\x89l\xc5\xa0\xb6\x02\xb9\n\xc8\xeb\xca\x06\xd0'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0575787'
      k = b'_pid'
      v = b'75787'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x705918bf6440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x705918bf64a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x705918bf64a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7498dc6ad120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7498dbb043a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7498dbb043a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7498dbb04430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7498dbb043a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7498dbb04430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7498dbb04430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7498dbb044c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7498dc557640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7498dc59b880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7498dbb04550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7498dc50a830>, <class 'int'>: <function escape_int at 0x7498dc50a8c0>, <class 'float'>: <function escape_float at 0x7498dc50a950>, <class 'str'>: <function escape_str at 0x7498dc50ab90>, <class 'bytes'>: <function escape_bytes at 0x7498dc50ab00>, <class 'tuple'>: <function escape_sequence at 0x7498dc50a710>, <class 'list'>: <function escape_sequence at 0x7498dc50a710>, <class 'set'>: <function escape_sequence at 0x7498dc50a710>, <class 'frozenset'>: <function escape_sequence at 0x7498dc50a710>, <class 'dict'>: <function escape_dict at 0x7498dc50a680>, <class 'NoneType'>: <function escape_None at 0x7498dc50ac20>, <class 'datetime.date'>: <function escape_date at 0x7498dc50ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7498dc50add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7498dc50acb0>, <class 'datetime.time'>: <function escape_time at 0x7498dc50ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7498dbb04550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7498dbb04550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xeb\xc1\xe2\xffM\xdc(\xee\xabz\xd1\x88Q\xe6\xe5\xf2\x9c\xd2*\x97_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06127659'
      authresp = b'\xeb\xc1\xe2\xffM\xdc(\xee\xabz\xd1\x88Q\xe6\xe5\xf2\x9c\xd2*\x97'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06127659'
      k = b'_pid'
      v = b'127659'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7498dbb04550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7498dbb04af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7498dbb04af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7498dc6ad120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7498dc576e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7498dc576e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7498dc577460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7498dc576e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7498dc577460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7498dc577460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dbb043a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7498dbb049d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7498dc557640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7498dc59b880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dbb043a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dbb043a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dbb043a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dbb043a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dbb043a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7498dbb04ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7498dc50a830>, <class 'int'>: <function escape_int at 0x7498dc50a8c0>, <class 'float'>: <function escape_float at 0x7498dc50a950>, <class 'str'>: <function escape_str at 0x7498dc50ab90>, <class 'bytes'>: <function escape_bytes at 0x7498dc50ab00>, <class 'tuple'>: <function escape_sequence at 0x7498dc50a710>, <class 'list'>: <function escape_sequence at 0x7498dc50a710>, <class 'set'>: <function escape_sequence at 0x7498dc50a710>, <class 'frozenset'>: <function escape_sequence at 0x7498dc50a710>, <class 'dict'>: <function escape_dict at 0x7498dc50a680>, <class 'NoneType'>: <function escape_None at 0x7498dc50ac20>, <class 'datetime.date'>: <function escape_date at 0x7498dc50ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7498dc50add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7498dc50acb0>, <class 'datetime.time'>: <function escape_time at 0x7498dc50ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7498dbb04ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7498dbb04ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xd3I\xf6\xf0\xe1\x08\xc5Z\xafA`C3xk)\xf5n\x90\x1a_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06127659'
      authresp = b'\xd3I\xf6\xf0\xe1\x08\xc5Z\xafA`C3xk)\xf5n\x90\x1a'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06127659'
      k = b'_pid'
      v = b'127659'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7498dbb04ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7498dbb06470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7498dbb06470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7498dc6ad120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7498dbb043a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7498dbb043a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7498dbb044c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7498dbb043a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7498dbb044c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7498dbb044c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7498dbb06500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7498dc557640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7498dc59b880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7498dc576e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7498dbb06470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7498dc50a830>, <class 'int'>: <function escape_int at 0x7498dc50a8c0>, <class 'float'>: <function escape_float at 0x7498dc50a950>, <class 'str'>: <function escape_str at 0x7498dc50ab90>, <class 'bytes'>: <function escape_bytes at 0x7498dc50ab00>, <class 'tuple'>: <function escape_sequence at 0x7498dc50a710>, <class 'list'>: <function escape_sequence at 0x7498dc50a710>, <class 'set'>: <function escape_sequence at 0x7498dc50a710>, <class 'frozenset'>: <function escape_sequence at 0x7498dc50a710>, <class 'dict'>: <function escape_dict at 0x7498dc50a680>, <class 'NoneType'>: <function escape_None at 0x7498dc50ac20>, <class 'datetime.date'>: <function escape_date at 0x7498dc50ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7498dc50add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7498dc50acb0>, <class 'datetime.time'>: <function escape_time at 0x7498dc50ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7498dbb06470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7498dbb06470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x1c\x14\xeb\x94\x02E\x0cl\x04\xad\x06\xe5\xae\xe2\xb534h\xdd\xed_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06127659'
      authresp = b'\x1c\x14\xeb\x94\x02E\x0cl\x04\xad\x06\xe5\xae\xe2\xb534h\xdd\xed'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06127659'
      k = b'_pid'
      v = b'127659'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7498dbb06470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7498dbb064d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7498dbb064d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x73869b099120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73869afec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73869afec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73869afec430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73869afec3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73869afec430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73869afec430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x73869afec4c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x73869af7f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x73869afc3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x73869afec550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x73869af32830>, <class 'int'>: <function escape_int at 0x73869af328c0>, <class 'float'>: <function escape_float at 0x73869af32950>, <class 'str'>: <function escape_str at 0x73869af32b90>, <class 'bytes'>: <function escape_bytes at 0x73869af32b00>, <class 'tuple'>: <function escape_sequence at 0x73869af32710>, <class 'list'>: <function escape_sequence at 0x73869af32710>, <class 'set'>: <function escape_sequence at 0x73869af32710>, <class 'frozenset'>: <function escape_sequence at 0x73869af32710>, <class 'dict'>: <function escape_dict at 0x73869af32680>, <class 'NoneType'>: <function escape_None at 0x73869af32c20>, <class 'datetime.date'>: <function escape_date at 0x73869af32e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x73869af32dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x73869af32cb0>, <class 'datetime.time'>: <function escape_time at 0x73869af32d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x73869afec550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x73869afec550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xab\xf8ep\x85"\xf3\xbbK\xb8b\x12\xf0hi\xa2{l:\xf6_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06142500'
      authresp = b'\xab\xf8ep\x85"\xf3\xbbK\xb8b\x12\xf0hi\xa2{l:\xf6'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06142500'
      k = b'_pid'
      v = b'142500'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x73869afec550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x73869afecaf0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x73869afecaf0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x73869b099120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73869af9ee60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73869af9ee60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73869af9f460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73869af9ee60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73869af9f460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73869af9f460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869afec3a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x73869afec9d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x73869af7f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x73869afc3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869afec3a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869afec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869afec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869afec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869afec3a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x73869afecac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x73869af32830>, <class 'int'>: <function escape_int at 0x73869af328c0>, <class 'float'>: <function escape_float at 0x73869af32950>, <class 'str'>: <function escape_str at 0x73869af32b90>, <class 'bytes'>: <function escape_bytes at 0x73869af32b00>, <class 'tuple'>: <function escape_sequence at 0x73869af32710>, <class 'list'>: <function escape_sequence at 0x73869af32710>, <class 'set'>: <function escape_sequence at 0x73869af32710>, <class 'frozenset'>: <function escape_sequence at 0x73869af32710>, <class 'dict'>: <function escape_dict at 0x73869af32680>, <class 'NoneType'>: <function escape_None at 0x73869af32c20>, <class 'datetime.date'>: <function escape_date at 0x73869af32e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x73869af32dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x73869af32cb0>, <class 'datetime.time'>: <function escape_time at 0x73869af32d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x73869afecac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x73869afecac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xc7\x94uw^/].L\x11\xc7\xc5y\\\xdeO\xc6\xa3\xd2\xc4_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06142500'
      authresp = b'\xc7\x94uw^/].L\x11\xc7\xc5y\\\xdeO\xc6\xa3\xd2\xc4'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06142500'
      k = b'_pid'
      v = b'142500'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x73869afecac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x73869afee470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x73869afee470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x73869b099120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73869afec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73869afec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73869afec4c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73869afec3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73869afec4c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73869afec4c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x73869afee500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x73869af7f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x73869afc3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73869af9ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x73869afee470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x73869af32830>, <class 'int'>: <function escape_int at 0x73869af328c0>, <class 'float'>: <function escape_float at 0x73869af32950>, <class 'str'>: <function escape_str at 0x73869af32b90>, <class 'bytes'>: <function escape_bytes at 0x73869af32b00>, <class 'tuple'>: <function escape_sequence at 0x73869af32710>, <class 'list'>: <function escape_sequence at 0x73869af32710>, <class 'set'>: <function escape_sequence at 0x73869af32710>, <class 'frozenset'>: <function escape_sequence at 0x73869af32710>, <class 'dict'>: <function escape_dict at 0x73869af32680>, <class 'NoneType'>: <function escape_None at 0x73869af32c20>, <class 'datetime.date'>: <function escape_date at 0x73869af32e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x73869af32dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x73869af32cb0>, <class 'datetime.time'>: <function escape_time at 0x73869af32d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x73869afee470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x73869afee470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14A\x935W\x8d\x95\t\xd6\xe3y+\xdeId\xa3V\x11-\xf0}_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06142500'
      authresp = b'A\x935W\x8d\x95\t\xd6\xe3y+\xdeId\xa3V\x11-\xf0}'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06142500'
      k = b'_pid'
      v = b'142500'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x73869afee470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x73869afee4d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x73869afee4d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x780cdf5b1120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780cdea043a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780cdea043a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780cdea04430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780cdea043a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780cdea04430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780cdea04430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x780cdea044c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x780cdeb97640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x780cdebdb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x780cdea04550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x780cdeb4a830>, <class 'int'>: <function escape_int at 0x780cdeb4a8c0>, <class 'float'>: <function escape_float at 0x780cdeb4a950>, <class 'str'>: <function escape_str at 0x780cdeb4ab90>, <class 'bytes'>: <function escape_bytes at 0x780cdeb4ab00>, <class 'tuple'>: <function escape_sequence at 0x780cdeb4a710>, <class 'list'>: <function escape_sequence at 0x780cdeb4a710>, <class 'set'>: <function escape_sequence at 0x780cdeb4a710>, <class 'frozenset'>: <function escape_sequence at 0x780cdeb4a710>, <class 'dict'>: <function escape_dict at 0x780cdeb4a680>, <class 'NoneType'>: <function escape_None at 0x780cdeb4ac20>, <class 'datetime.date'>: <function escape_date at 0x780cdeb4ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x780cdeb4add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x780cdeb4acb0>, <class 'datetime.time'>: <function escape_time at 0x780cdeb4ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x780cdea04550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x780cdea04550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xb7\xb6\x97B2\xca\xca\xb8\x97\xd5\xae\xd8\xadiI\xc2\xe5\n\xcc\xcb_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06148736'
      authresp = b'\xb7\xb6\x97B2\xca\xca\xb8\x97\xd5\xae\xd8\xadiI\xc2\xe5\n\xcc\xcb'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06148736'
      k = b'_pid'
      v = b'148736'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x780cdea04550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x780cdea04af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x780cdea04af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x780cdf5b1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780cdebb6e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780cdebb6e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780cdebb7460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780cdebb6e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780cdebb7460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780cdebb7460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdea043a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x780cdea049d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x780cdeb97640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x780cdebdb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdea043a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdea043a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdea043a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdea043a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdea043a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x780cdea04ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x780cdeb4a830>, <class 'int'>: <function escape_int at 0x780cdeb4a8c0>, <class 'float'>: <function escape_float at 0x780cdeb4a950>, <class 'str'>: <function escape_str at 0x780cdeb4ab90>, <class 'bytes'>: <function escape_bytes at 0x780cdeb4ab00>, <class 'tuple'>: <function escape_sequence at 0x780cdeb4a710>, <class 'list'>: <function escape_sequence at 0x780cdeb4a710>, <class 'set'>: <function escape_sequence at 0x780cdeb4a710>, <class 'frozenset'>: <function escape_sequence at 0x780cdeb4a710>, <class 'dict'>: <function escape_dict at 0x780cdeb4a680>, <class 'NoneType'>: <function escape_None at 0x780cdeb4ac20>, <class 'datetime.date'>: <function escape_date at 0x780cdeb4ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x780cdeb4add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x780cdeb4acb0>, <class 'datetime.time'>: <function escape_time at 0x780cdeb4ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x780cdea04ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x780cdea04ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x10\x11X\x0b\x8a\x167=\xb4e\xed#\x84\xaf-13\xb6]Z_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06148736'
      authresp = b'\x10\x11X\x0b\x8a\x167=\xb4e\xed#\x84\xaf-13\xb6]Z'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06148736'
      k = b'_pid'
      v = b'148736'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x780cdea04ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x780cdea06470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x780cdea06470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x780cdf5b1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780cdea043a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780cdea043a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780cdea044c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780cdea043a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780cdea044c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780cdea044c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x780cdea06500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x780cdeb97640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x780cdebdb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780cdebb6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x780cdea06470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x780cdeb4a830>, <class 'int'>: <function escape_int at 0x780cdeb4a8c0>, <class 'float'>: <function escape_float at 0x780cdeb4a950>, <class 'str'>: <function escape_str at 0x780cdeb4ab90>, <class 'bytes'>: <function escape_bytes at 0x780cdeb4ab00>, <class 'tuple'>: <function escape_sequence at 0x780cdeb4a710>, <class 'list'>: <function escape_sequence at 0x780cdeb4a710>, <class 'set'>: <function escape_sequence at 0x780cdeb4a710>, <class 'frozenset'>: <function escape_sequence at 0x780cdeb4a710>, <class 'dict'>: <function escape_dict at 0x780cdeb4a680>, <class 'NoneType'>: <function escape_None at 0x780cdeb4ac20>, <class 'datetime.date'>: <function escape_date at 0x780cdeb4ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x780cdeb4add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x780cdeb4acb0>, <class 'datetime.time'>: <function escape_time at 0x780cdeb4ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x780cdea06470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x780cdea06470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x88fj\xfa\xf0\x1b\xe0M\xe9?\x8e\xc8\xe1\x017\xb0\x8d{\xedI_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06148736'
      authresp = b'\x88fj\xfa\xf0\x1b\xe0M\xe9?\x8e\xc8\xe1\x017\xb0\x8d{\xedI'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06148736'
      k = b'_pid'
      v = b'148736'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x780cdea06470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x780cdea064d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x780cdea064d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x779dde9a1120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x779dddff43a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x779dddff43a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x779dddff4430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x779dddff43a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x779dddff4430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x779dddff4430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x779dddff44c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x779dddf87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x779dddfcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x779dddff4550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x779dddf3a830>, <class 'int'>: <function escape_int at 0x779dddf3a8c0>, <class 'float'>: <function escape_float at 0x779dddf3a950>, <class 'str'>: <function escape_str at 0x779dddf3ab90>, <class 'bytes'>: <function escape_bytes at 0x779dddf3ab00>, <class 'tuple'>: <function escape_sequence at 0x779dddf3a710>, <class 'list'>: <function escape_sequence at 0x779dddf3a710>, <class 'set'>: <function escape_sequence at 0x779dddf3a710>, <class 'frozenset'>: <function escape_sequence at 0x779dddf3a710>, <class 'dict'>: <function escape_dict at 0x779dddf3a680>, <class 'NoneType'>: <function escape_None at 0x779dddf3ac20>, <class 'datetime.date'>: <function escape_date at 0x779dddf3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x779dddf3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x779dddf3acb0>, <class 'datetime.time'>: <function escape_time at 0x779dddf3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x779dddff4550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x779dddff4550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xc4\xa4\xe4GA\xa2\x99\n\xca-\xb9\x9a[Q\x84\xcb\x1en\xb8\n_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0543011'
      authresp = b'\xc4\xa4\xe4GA\xa2\x99\n\xca-\xb9\x9a[Q\x84\xcb\x1en\xb8\n'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0543011'
      k = b'_pid'
      v = b'43011'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x779dddff4550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x779dddff4ac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x779dddff4ac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x779dde9a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x779dddfa6e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x779dddfa6e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x779dddfa7460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x779dddfa6e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x779dddfa7460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x779dddfa7460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddff43a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x779dddff49d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x779dddf87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x779dddfcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddff43a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddff43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddff43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddff43a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddff43a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x779dddff4a90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x779dddf3a830>, <class 'int'>: <function escape_int at 0x779dddf3a8c0>, <class 'float'>: <function escape_float at 0x779dddf3a950>, <class 'str'>: <function escape_str at 0x779dddf3ab90>, <class 'bytes'>: <function escape_bytes at 0x779dddf3ab00>, <class 'tuple'>: <function escape_sequence at 0x779dddf3a710>, <class 'list'>: <function escape_sequence at 0x779dddf3a710>, <class 'set'>: <function escape_sequence at 0x779dddf3a710>, <class 'frozenset'>: <function escape_sequence at 0x779dddf3a710>, <class 'dict'>: <function escape_dict at 0x779dddf3a680>, <class 'NoneType'>: <function escape_None at 0x779dddf3ac20>, <class 'datetime.date'>: <function escape_date at 0x779dddf3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x779dddf3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x779dddf3acb0>, <class 'datetime.time'>: <function escape_time at 0x779dddf3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x779dddff4a90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x779dddff4a90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14G\xca}\xe2p\x03i\xf1\xde<\xfc\xe3 5Y0\x10V\xfc\xca_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0543011'
      authresp = b'G\xca}\xe2p\x03i\xf1\xde<\xfc\xe3 5Y0\x10V\xfc\xca'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0543011'
      k = b'_pid'
      v = b'43011'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x779dddff4a90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x779dddff6440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x779dddff6440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x779dde9a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x779dddff43a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x779dddff43a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x779dddff44c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x779dddff43a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x779dddff44c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x779dddff44c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x779dddff64d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x779dddf87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x779dddfcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x779dddfa6e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x779dddff6440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x779dddf3a830>, <class 'int'>: <function escape_int at 0x779dddf3a8c0>, <class 'float'>: <function escape_float at 0x779dddf3a950>, <class 'str'>: <function escape_str at 0x779dddf3ab90>, <class 'bytes'>: <function escape_bytes at 0x779dddf3ab00>, <class 'tuple'>: <function escape_sequence at 0x779dddf3a710>, <class 'list'>: <function escape_sequence at 0x779dddf3a710>, <class 'set'>: <function escape_sequence at 0x779dddf3a710>, <class 'frozenset'>: <function escape_sequence at 0x779dddf3a710>, <class 'dict'>: <function escape_dict at 0x779dddf3a680>, <class 'NoneType'>: <function escape_None at 0x779dddf3ac20>, <class 'datetime.date'>: <function escape_date at 0x779dddf3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x779dddf3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x779dddf3acb0>, <class 'datetime.time'>: <function escape_time at 0x779dddf3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x779dddff6440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x779dddff6440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14I\xc7(\xbf\\\x1d\xc2\x94\xe4\x81\xf3\xce\xba(]\x83\xb3\x99\xf6\xac_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0543011'
      authresp = b'I\xc7(\xbf\\\x1d\xc2\x94\xe4\x81\xf3\xce\xba(]\x83\xb3\x99\xf6\xac'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0543011'
      k = b'_pid'
      v = b'43011'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x779dddff6440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x779dddff64a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x779dddff64a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x78b772ab5120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b771f083a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b771f083a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b771f08430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b771f083a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b771f08430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b771f08430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x78b771f084c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x78b77299b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x78b7729df880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x78b771f08550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x78b77294e830>, <class 'int'>: <function escape_int at 0x78b77294e8c0>, <class 'float'>: <function escape_float at 0x78b77294e950>, <class 'str'>: <function escape_str at 0x78b77294eb90>, <class 'bytes'>: <function escape_bytes at 0x78b77294eb00>, <class 'tuple'>: <function escape_sequence at 0x78b77294e710>, <class 'list'>: <function escape_sequence at 0x78b77294e710>, <class 'set'>: <function escape_sequence at 0x78b77294e710>, <class 'frozenset'>: <function escape_sequence at 0x78b77294e710>, <class 'dict'>: <function escape_dict at 0x78b77294e680>, <class 'NoneType'>: <function escape_None at 0x78b77294ec20>, <class 'datetime.date'>: <function escape_date at 0x78b77294ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x78b77294edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x78b77294ecb0>, <class 'datetime.time'>: <function escape_time at 0x78b77294ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x78b771f08550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x78b771f08550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b"\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14'\xb9\xaeL\xac\xd4fk\x87\x11m\xa6Q\xc5\xce\x17!.\xa7\xf5_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06116422"
      authresp = b"'\xb9\xaeL\xac\xd4fk\x87\x11m\xa6Q\xc5\xce\x17!.\xa7\xf5"
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06116422'
      k = b'_pid'
      v = b'116422'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x78b771f08550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x78b771f08af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x78b771f08af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x78b772ab5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b7729bae60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b7729bae60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b7729bb460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b7729bae60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b7729bb460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b7729bb460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b771f083a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x78b771f089d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x78b77299b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x78b7729df880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b771f083a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b771f083a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b771f083a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b771f083a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b771f083a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x78b771f08ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x78b77294e830>, <class 'int'>: <function escape_int at 0x78b77294e8c0>, <class 'float'>: <function escape_float at 0x78b77294e950>, <class 'str'>: <function escape_str at 0x78b77294eb90>, <class 'bytes'>: <function escape_bytes at 0x78b77294eb00>, <class 'tuple'>: <function escape_sequence at 0x78b77294e710>, <class 'list'>: <function escape_sequence at 0x78b77294e710>, <class 'set'>: <function escape_sequence at 0x78b77294e710>, <class 'frozenset'>: <function escape_sequence at 0x78b77294e710>, <class 'dict'>: <function escape_dict at 0x78b77294e680>, <class 'NoneType'>: <function escape_None at 0x78b77294ec20>, <class 'datetime.date'>: <function escape_date at 0x78b77294ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x78b77294edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x78b77294ecb0>, <class 'datetime.time'>: <function escape_time at 0x78b77294ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x78b771f08ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x78b771f08ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x08\x12\xb4S:\xa4\x91\x8b4>L\xb8\xc6\xae\xdd\xdc\x1d\x963\x12_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06116422'
      authresp = b'\x08\x12\xb4S:\xa4\x91\x8b4>L\xb8\xc6\xae\xdd\xdc\x1d\x963\x12'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06116422'
      k = b'_pid'
      v = b'116422'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x78b771f08ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x78b771f0a470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x78b771f0a470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x78b772ab5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b771f083a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b771f083a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b771f084c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b771f083a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b771f084c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b771f084c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x78b771f0a500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x78b77299b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x78b7729df880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7729bae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x78b771f0a470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x78b77294e830>, <class 'int'>: <function escape_int at 0x78b77294e8c0>, <class 'float'>: <function escape_float at 0x78b77294e950>, <class 'str'>: <function escape_str at 0x78b77294eb90>, <class 'bytes'>: <function escape_bytes at 0x78b77294eb00>, <class 'tuple'>: <function escape_sequence at 0x78b77294e710>, <class 'list'>: <function escape_sequence at 0x78b77294e710>, <class 'set'>: <function escape_sequence at 0x78b77294e710>, <class 'frozenset'>: <function escape_sequence at 0x78b77294e710>, <class 'dict'>: <function escape_dict at 0x78b77294e680>, <class 'NoneType'>: <function escape_None at 0x78b77294ec20>, <class 'datetime.date'>: <function escape_date at 0x78b77294ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x78b77294edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x78b77294ecb0>, <class 'datetime.time'>: <function escape_time at 0x78b77294ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x78b771f0a470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x78b771f0a470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xcba\xd1\xf4\x97n\x16bVl?\x1c\x8a\xac\xb7\xa1}\xa3&\x98_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06116422'
      authresp = b'\xcba\xd1\xf4\x97n\x16bVl?\x1c\x8a\xac\xb7\xa1}\xa3&\x98'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06116422'
      k = b'_pid'
      v = b'116422'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x78b771f0a470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x78b771f0a4d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x78b771f0a4d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x799e0ef9d120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x799e0e5f03a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x799e0e5f03a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x799e0e5f0430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x799e0e5f03a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x799e0e5f0430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x799e0e5f0430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x799e0e5f04c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x799e0e583640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x799e0e5c7880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x799e0e5f0550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x799e0e536830>, <class 'int'>: <function escape_int at 0x799e0e5368c0>, <class 'float'>: <function escape_float at 0x799e0e536950>, <class 'str'>: <function escape_str at 0x799e0e536b90>, <class 'bytes'>: <function escape_bytes at 0x799e0e536b00>, <class 'tuple'>: <function escape_sequence at 0x799e0e536710>, <class 'list'>: <function escape_sequence at 0x799e0e536710>, <class 'set'>: <function escape_sequence at 0x799e0e536710>, <class 'frozenset'>: <function escape_sequence at 0x799e0e536710>, <class 'dict'>: <function escape_dict at 0x799e0e536680>, <class 'NoneType'>: <function escape_None at 0x799e0e536c20>, <class 'datetime.date'>: <function escape_date at 0x799e0e536e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x799e0e536dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x799e0e536cb0>, <class 'datetime.time'>: <function escape_time at 0x799e0e536d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x799e0e5f0550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x799e0e5f0550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14`u\x14`j\x162>\x96\x005\x9e4\x07]\x07NI\xb2\x1a_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06139268'
      authresp = b'`u\x14`j\x162>\x96\x005\x9e4\x07]\x07NI\xb2\x1a'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06139268'
      k = b'_pid'
      v = b'139268'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x799e0e5f0550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x799e0e5f0af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x799e0e5f0af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x799e0ef9d120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x799e0e5a2e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x799e0e5a2e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x799e0e5a3460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x799e0e5a2e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x799e0e5a3460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x799e0e5a3460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5f03a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x799e0e5f09d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x799e0e583640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x799e0e5c7880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5f03a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5f03a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5f03a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5f03a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5f03a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x799e0e5f0ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x799e0e536830>, <class 'int'>: <function escape_int at 0x799e0e5368c0>, <class 'float'>: <function escape_float at 0x799e0e536950>, <class 'str'>: <function escape_str at 0x799e0e536b90>, <class 'bytes'>: <function escape_bytes at 0x799e0e536b00>, <class 'tuple'>: <function escape_sequence at 0x799e0e536710>, <class 'list'>: <function escape_sequence at 0x799e0e536710>, <class 'set'>: <function escape_sequence at 0x799e0e536710>, <class 'frozenset'>: <function escape_sequence at 0x799e0e536710>, <class 'dict'>: <function escape_dict at 0x799e0e536680>, <class 'NoneType'>: <function escape_None at 0x799e0e536c20>, <class 'datetime.date'>: <function escape_date at 0x799e0e536e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x799e0e536dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x799e0e536cb0>, <class 'datetime.time'>: <function escape_time at 0x799e0e536d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x799e0e5f0ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x799e0e5f0ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xfeVn6\x8b\xccf\xa3\xac\xc5\xed\\\x11\xf5?\xe6\xc7\x91Y\xfb_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06139268'
      authresp = b'\xfeVn6\x8b\xccf\xa3\xac\xc5\xed\\\x11\xf5?\xe6\xc7\x91Y\xfb'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06139268'
      k = b'_pid'
      v = b'139268'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x799e0e5f0ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x799e0e5f2470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x799e0e5f2470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x799e0ef9d120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x799e0e5f03a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x799e0e5f03a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x799e0e5f04c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x799e0e5f03a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x799e0e5f04c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x799e0e5f04c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x799e0e5f2500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x799e0e583640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x799e0e5c7880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x799e0e5a2e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x799e0e5f2470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x799e0e536830>, <class 'int'>: <function escape_int at 0x799e0e5368c0>, <class 'float'>: <function escape_float at 0x799e0e536950>, <class 'str'>: <function escape_str at 0x799e0e536b90>, <class 'bytes'>: <function escape_bytes at 0x799e0e536b00>, <class 'tuple'>: <function escape_sequence at 0x799e0e536710>, <class 'list'>: <function escape_sequence at 0x799e0e536710>, <class 'set'>: <function escape_sequence at 0x799e0e536710>, <class 'frozenset'>: <function escape_sequence at 0x799e0e536710>, <class 'dict'>: <function escape_dict at 0x799e0e536680>, <class 'NoneType'>: <function escape_None at 0x799e0e536c20>, <class 'datetime.date'>: <function escape_date at 0x799e0e536e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x799e0e536dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x799e0e536cb0>, <class 'datetime.time'>: <function escape_time at 0x799e0e536d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x799e0e5f2470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x799e0e5f2470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xf2o\x00\xc6\x84E\x82=|\x86/\xe9qh\x9f:\r\x8e,\xe2_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06139268'
      authresp = b'\xf2o\x00\xc6\x84E\x82=|\x86/\xe9qh\x9f:\r\x8e,\xe2'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06139268'
      k = b'_pid'
      v = b'139268'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x799e0e5f2470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x799e0e5f24d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x799e0e5f24d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x77a0b8699120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x77a0b85ec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x77a0b85ec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x77a0b85ec430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x77a0b85ec3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x77a0b85ec430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x77a0b85ec430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x77a0b85ec4c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x77a0b857f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x77a0b85c3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x77a0b85ec550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x77a0b8532830>, <class 'int'>: <function escape_int at 0x77a0b85328c0>, <class 'float'>: <function escape_float at 0x77a0b8532950>, <class 'str'>: <function escape_str at 0x77a0b8532b90>, <class 'bytes'>: <function escape_bytes at 0x77a0b8532b00>, <class 'tuple'>: <function escape_sequence at 0x77a0b8532710>, <class 'list'>: <function escape_sequence at 0x77a0b8532710>, <class 'set'>: <function escape_sequence at 0x77a0b8532710>, <class 'frozenset'>: <function escape_sequence at 0x77a0b8532710>, <class 'dict'>: <function escape_dict at 0x77a0b8532680>, <class 'NoneType'>: <function escape_None at 0x77a0b8532c20>, <class 'datetime.date'>: <function escape_date at 0x77a0b8532e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x77a0b8532dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x77a0b8532cb0>, <class 'datetime.time'>: <function escape_time at 0x77a0b8532d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x77a0b85ec550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x77a0b85ec550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x84z\xb6\x92\xdb\xdb\xf7U\xd6l\x97\xb6\xe4{\xder\xb4>j\xfc_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0513902'
      authresp = b'\x84z\xb6\x92\xdb\xdb\xf7U\xd6l\x97\xb6\xe4{\xder\xb4>j\xfc'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0513902'
      k = b'_pid'
      v = b'13902'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x77a0b85ec550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x77a0b85ecac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x77a0b85ecac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x77a0b8699120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x77a0b859ee60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x77a0b859ee60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x77a0b859f460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x77a0b859ee60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x77a0b859f460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x77a0b859f460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b85ec3a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x77a0b85ec9d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x77a0b857f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x77a0b85c3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b85ec3a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b85ec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b85ec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b85ec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b85ec3a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x77a0b85eca90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x77a0b8532830>, <class 'int'>: <function escape_int at 0x77a0b85328c0>, <class 'float'>: <function escape_float at 0x77a0b8532950>, <class 'str'>: <function escape_str at 0x77a0b8532b90>, <class 'bytes'>: <function escape_bytes at 0x77a0b8532b00>, <class 'tuple'>: <function escape_sequence at 0x77a0b8532710>, <class 'list'>: <function escape_sequence at 0x77a0b8532710>, <class 'set'>: <function escape_sequence at 0x77a0b8532710>, <class 'frozenset'>: <function escape_sequence at 0x77a0b8532710>, <class 'dict'>: <function escape_dict at 0x77a0b8532680>, <class 'NoneType'>: <function escape_None at 0x77a0b8532c20>, <class 'datetime.date'>: <function escape_date at 0x77a0b8532e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x77a0b8532dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x77a0b8532cb0>, <class 'datetime.time'>: <function escape_time at 0x77a0b8532d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x77a0b85eca90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x77a0b85eca90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\r(\xa0h\xd4\xfaSx\x9dC`/\x9d\xa4m\x12\x18\xbc\x8f\x0f_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0513902'
      authresp = b'\r(\xa0h\xd4\xfaSx\x9dC`/\x9d\xa4m\x12\x18\xbc\x8f\x0f'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0513902'
      k = b'_pid'
      v = b'13902'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x77a0b85eca90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x77a0b85ee440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x77a0b85ee440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x77a0b8699120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x77a0b85ec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x77a0b85ec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x77a0b85ec4c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x77a0b85ec3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x77a0b85ec4c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x77a0b85ec4c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x77a0b85ee4d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x77a0b857f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x77a0b85c3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x77a0b859ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x77a0b85ee440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x77a0b8532830>, <class 'int'>: <function escape_int at 0x77a0b85328c0>, <class 'float'>: <function escape_float at 0x77a0b8532950>, <class 'str'>: <function escape_str at 0x77a0b8532b90>, <class 'bytes'>: <function escape_bytes at 0x77a0b8532b00>, <class 'tuple'>: <function escape_sequence at 0x77a0b8532710>, <class 'list'>: <function escape_sequence at 0x77a0b8532710>, <class 'set'>: <function escape_sequence at 0x77a0b8532710>, <class 'frozenset'>: <function escape_sequence at 0x77a0b8532710>, <class 'dict'>: <function escape_dict at 0x77a0b8532680>, <class 'NoneType'>: <function escape_None at 0x77a0b8532c20>, <class 'datetime.date'>: <function escape_date at 0x77a0b8532e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x77a0b8532dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x77a0b8532cb0>, <class 'datetime.time'>: <function escape_time at 0x77a0b8532d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x77a0b85ee440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x77a0b85ee440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14V\xba\xdd\xc5.\x03\x92\x99\xe6\x06\xf0\xe4\xae\xc7@\x9c\xb2x\xaf\t_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0513902'
      authresp = b'V\xba\xdd\xc5.\x03\x92\x99\xe6\x06\xf0\xe4\xae\xc7@\x9c\xb2x\xaf\t'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0513902'
      k = b'_pid'
      v = b'13902'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x77a0b85ee440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x77a0b85ee4a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x77a0b85ee4a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7b8557fc5120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7b85574183a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7b85574183a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7b8557418430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7b85574183a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7b8557418430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7b8557418430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7b85574184c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7b85575ab640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7b85575ef880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7b8557418550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7b855755e830>, <class 'int'>: <function escape_int at 0x7b855755e8c0>, <class 'float'>: <function escape_float at 0x7b855755e950>, <class 'str'>: <function escape_str at 0x7b855755eb90>, <class 'bytes'>: <function escape_bytes at 0x7b855755eb00>, <class 'tuple'>: <function escape_sequence at 0x7b855755e710>, <class 'list'>: <function escape_sequence at 0x7b855755e710>, <class 'set'>: <function escape_sequence at 0x7b855755e710>, <class 'frozenset'>: <function escape_sequence at 0x7b855755e710>, <class 'dict'>: <function escape_dict at 0x7b855755e680>, <class 'NoneType'>: <function escape_None at 0x7b855755ec20>, <class 'datetime.date'>: <function escape_date at 0x7b855755ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7b855755edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7b855755ecb0>, <class 'datetime.time'>: <function escape_time at 0x7b855755ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7b8557418550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7b8557418550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x91\x9c\x98\xb3\x95\x16\x90L\xa2\xee\xe7\x86JP\\\x90S\xf8\x03\xfd_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0545443'
      authresp = b'\x91\x9c\x98\xb3\x95\x16\x90L\xa2\xee\xe7\x86JP\\\x90S\xf8\x03\xfd'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0545443'
      k = b'_pid'
      v = b'45443'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7b8557418550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7b8557418ac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7b8557418ac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7b8557fc5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7b85575cae60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7b85575cae60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7b85575cb460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7b85575cae60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7b85575cb460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7b85575cb460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85574183a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7b85574189d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7b85575ab640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7b85575ef880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85574183a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85574183a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85574183a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85574183a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85574183a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7b8557418a90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7b855755e830>, <class 'int'>: <function escape_int at 0x7b855755e8c0>, <class 'float'>: <function escape_float at 0x7b855755e950>, <class 'str'>: <function escape_str at 0x7b855755eb90>, <class 'bytes'>: <function escape_bytes at 0x7b855755eb00>, <class 'tuple'>: <function escape_sequence at 0x7b855755e710>, <class 'list'>: <function escape_sequence at 0x7b855755e710>, <class 'set'>: <function escape_sequence at 0x7b855755e710>, <class 'frozenset'>: <function escape_sequence at 0x7b855755e710>, <class 'dict'>: <function escape_dict at 0x7b855755e680>, <class 'NoneType'>: <function escape_None at 0x7b855755ec20>, <class 'datetime.date'>: <function escape_date at 0x7b855755ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7b855755edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7b855755ecb0>, <class 'datetime.time'>: <function escape_time at 0x7b855755ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7b8557418a90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7b8557418a90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x81\xe2\x01\xe0\x1e\x02\xd6nXd\x83\x8e\x8c,e\xf5\\|l\xb2_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0545443'
      authresp = b'\x81\xe2\x01\xe0\x1e\x02\xd6nXd\x83\x8e\x8c,e\xf5\\|l\xb2'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0545443'
      k = b'_pid'
      v = b'45443'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7b8557418a90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7b855741a440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7b855741a440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7b8557fc5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7b85574183a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7b85574183a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7b85574184c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7b85574183a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7b85574184c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7b85574184c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7b855741a4d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7b85575ab640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7b85575ef880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7b85575cae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7b855741a440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7b855755e830>, <class 'int'>: <function escape_int at 0x7b855755e8c0>, <class 'float'>: <function escape_float at 0x7b855755e950>, <class 'str'>: <function escape_str at 0x7b855755eb90>, <class 'bytes'>: <function escape_bytes at 0x7b855755eb00>, <class 'tuple'>: <function escape_sequence at 0x7b855755e710>, <class 'list'>: <function escape_sequence at 0x7b855755e710>, <class 'set'>: <function escape_sequence at 0x7b855755e710>, <class 'frozenset'>: <function escape_sequence at 0x7b855755e710>, <class 'dict'>: <function escape_dict at 0x7b855755e680>, <class 'NoneType'>: <function escape_None at 0x7b855755ec20>, <class 'datetime.date'>: <function escape_date at 0x7b855755ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7b855755edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7b855755ecb0>, <class 'datetime.time'>: <function escape_time at 0x7b855755ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7b855741a440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7b855741a440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xdd7\xd1\xe2\x92\xba\xfb\xc9\x18\xc9A{#\xa1\xfe\xb6\xec\x05\xba\xd8_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0545443'
      authresp = b'\xdd7\xd1\xe2\x92\xba\xfb\xc9\x18\xc9A{#\xa1\xfe\xb6\xec\x05\xba\xd8'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0545443'
      k = b'_pid'
      v = b'45443'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7b855741a440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7b855741a4a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7b855741a4a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f8c465b1120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8c45a086d0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8c45a086d0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8c45a08760>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8c45a086d0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8c45a08760>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8c45a08760>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45bb70d0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7f8c45a08850>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7f8c45b97640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7f8c45bdb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45bb70d0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45bb70d0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45bb70d0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45bb70d0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45bb70d0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7f8c45a089a0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7f8c45b4a830>, <class 'int'>: <function escape_int at 0x7f8c45b4a8c0>, <class 'float'>: <function escape_float at 0x7f8c45b4a950>, <class 'str'>: <function escape_str at 0x7f8c45b4ab90>, <class 'bytes'>: <function escape_bytes at 0x7f8c45b4ab00>, <class 'tuple'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'list'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'set'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'frozenset'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'dict'>: <function escape_dict at 0x7f8c45b4a680>, <class 'NoneType'>: <function escape_None at 0x7f8c45b4ac20>, <class 'datetime.date'>: <function escape_date at 0x7f8c45b4ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7f8c45b4add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7f8c45b4acb0>, <class 'datetime.time'>: <function escape_time at 0x7f8c45b4ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7f8c45a089a0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7f8c45a089a0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x11\xea\x84\x14\xc7\x98\x93_Z\x9b\xbfs\xd8\xda\xb0\x12~\x16\x17\x8b_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0580997'
      authresp = b'\x11\xea\x84\x14\xc7\x98\x93_Z\x9b\xbfs\xd8\xda\xb0\x12~\x16\x17\x8b'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0580997'
      k = b'_pid'
      v = b'80997'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7f8c45a089a0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7f8c45a08f10>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7f8c45a08f10>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f8c465b1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8c45a08f10>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8c45a08f10>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8c45a0ae90>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8c45a08f10>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8c45a0ae90>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8c45a0ae90>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a089a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7f8c45a0a980>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7f8c45b97640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7f8c45bdb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a089a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a089a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a089a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a089a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a089a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7f8c45a0a8f0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7f8c45b4a830>, <class 'int'>: <function escape_int at 0x7f8c45b4a8c0>, <class 'float'>: <function escape_float at 0x7f8c45b4a950>, <class 'str'>: <function escape_str at 0x7f8c45b4ab90>, <class 'bytes'>: <function escape_bytes at 0x7f8c45b4ab00>, <class 'tuple'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'list'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'set'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'frozenset'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'dict'>: <function escape_dict at 0x7f8c45b4a680>, <class 'NoneType'>: <function escape_None at 0x7f8c45b4ac20>, <class 'datetime.date'>: <function escape_date at 0x7f8c45b4ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7f8c45b4add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7f8c45b4acb0>, <class 'datetime.time'>: <function escape_time at 0x7f8c45b4ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7f8c45a0a8f0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7f8c45a0a8f0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x140vi\xc85\xc1\x1d\xa3&^B\x13\xbf\n\xc4\xdc\x8f\xe6]%_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0580997'
      authresp = b'0vi\xc85\xc1\x1d\xa3&^B\x13\xbf\n\xc4\xdc\x8f\xe6]%'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0580997'
      k = b'_pid'
      v = b'80997'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7f8c45a0a8f0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7f8c45a0ac80>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7f8c45a0ac80>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7f8c465b1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8c45a0ac80>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8c45a0ac80>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8c45a0a860>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7f8c45a0ac80>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8c45a0a860>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7f8c45a0a860>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a0a8f0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7f8c45a0aa70>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7f8c45b97640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7f8c45bdb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a0a8f0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a0a8f0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a0a8f0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a0a8f0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8c45a0a8f0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7f8c45a0ada0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7f8c45b4a830>, <class 'int'>: <function escape_int at 0x7f8c45b4a8c0>, <class 'float'>: <function escape_float at 0x7f8c45b4a950>, <class 'str'>: <function escape_str at 0x7f8c45b4ab90>, <class 'bytes'>: <function escape_bytes at 0x7f8c45b4ab00>, <class 'tuple'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'list'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'set'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'frozenset'>: <function escape_sequence at 0x7f8c45b4a710>, <class 'dict'>: <function escape_dict at 0x7f8c45b4a680>, <class 'NoneType'>: <function escape_None at 0x7f8c45b4ac20>, <class 'datetime.date'>: <function escape_date at 0x7f8c45b4ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7f8c45b4add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7f8c45b4acb0>, <class 'datetime.time'>: <function escape_time at 0x7f8c45b4ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7f8c45a0ada0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7f8c45a0ada0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x9cMG\xcas\xbc\xe7\xa1\xfd\xa9\x0e\xb1L Y\xa8n\xc8\xd8(_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0580997'
      authresp = b'\x9cMG\xcas\xbc\xe7\xa1\xfd\xa9\x0e\xb1L Y\xa8n\xc8\xd8('
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0580997'
      k = b'_pid'
      v = b'80997'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7f8c45a0ada0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7f8c45a0b0a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7f8c45a0b0a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x75f6487b5120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x75f647c0c6d0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x75f647c0c6d0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x75f647c0c760>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x75f647c0c6d0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x75f647c0c760>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x75f647c0c760>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647dbb0d0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x75f647c0c850>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x75f647d9b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x75f647ddf880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647dbb0d0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647dbb0d0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647dbb0d0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647dbb0d0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647dbb0d0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x75f647c0c9a0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x75f647d4e830>, <class 'int'>: <function escape_int at 0x75f647d4e8c0>, <class 'float'>: <function escape_float at 0x75f647d4e950>, <class 'str'>: <function escape_str at 0x75f647d4eb90>, <class 'bytes'>: <function escape_bytes at 0x75f647d4eb00>, <class 'tuple'>: <function escape_sequence at 0x75f647d4e710>, <class 'list'>: <function escape_sequence at 0x75f647d4e710>, <class 'set'>: <function escape_sequence at 0x75f647d4e710>, <class 'frozenset'>: <function escape_sequence at 0x75f647d4e710>, <class 'dict'>: <function escape_dict at 0x75f647d4e680>, <class 'NoneType'>: <function escape_None at 0x75f647d4ec20>, <class 'datetime.date'>: <function escape_date at 0x75f647d4ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x75f647d4edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x75f647d4ecb0>, <class 'datetime.time'>: <function escape_time at 0x75f647d4ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x75f647c0c9a0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x75f647c0c9a0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b"\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xef\x88\xfe\xd9'\xd0B\xfe\x10\xe0\xd0\x95\xb0\xbf\x971Q\xb4\xb6\x0f_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0583868"
      authresp = b"\xef\x88\xfe\xd9'\xd0B\xfe\x10\xe0\xd0\x95\xb0\xbf\x971Q\xb4\xb6\x0f"
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0583868'
      k = b'_pid'
      v = b'83868'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x75f647c0c9a0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x75f647c0cf10>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x75f647c0cf10>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x75f6487b5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x75f647c0cf10>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x75f647c0cf10>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x75f647c0ee90>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x75f647c0cf10>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x75f647c0ee90>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x75f647c0ee90>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0c9a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x75f647c0e980>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x75f647d9b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x75f647ddf880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0c9a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0c9a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0c9a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0c9a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0c9a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x75f647c0e8f0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x75f647d4e830>, <class 'int'>: <function escape_int at 0x75f647d4e8c0>, <class 'float'>: <function escape_float at 0x75f647d4e950>, <class 'str'>: <function escape_str at 0x75f647d4eb90>, <class 'bytes'>: <function escape_bytes at 0x75f647d4eb00>, <class 'tuple'>: <function escape_sequence at 0x75f647d4e710>, <class 'list'>: <function escape_sequence at 0x75f647d4e710>, <class 'set'>: <function escape_sequence at 0x75f647d4e710>, <class 'frozenset'>: <function escape_sequence at 0x75f647d4e710>, <class 'dict'>: <function escape_dict at 0x75f647d4e680>, <class 'NoneType'>: <function escape_None at 0x75f647d4ec20>, <class 'datetime.date'>: <function escape_date at 0x75f647d4ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x75f647d4edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x75f647d4ecb0>, <class 'datetime.time'>: <function escape_time at 0x75f647d4ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x75f647c0e8f0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x75f647c0e8f0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b"\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xb5\x9cUQ#\xb6\x86B\x88\xb2\x8a\xa6E\xb0u\xe1\xd5'\x04\x06_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0583868"
      authresp = b"\xb5\x9cUQ#\xb6\x86B\x88\xb2\x8a\xa6E\xb0u\xe1\xd5'\x04\x06"
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0583868'
      k = b'_pid'
      v = b'83868'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x75f647c0e8f0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x75f647c0ec80>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x75f647c0ec80>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x75f6487b5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x75f647c0ec80>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x75f647c0ec80>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x75f647c0e860>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x75f647c0ec80>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x75f647c0e860>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x75f647c0e860>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0e8f0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x75f647c0ea70>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x75f647d9b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x75f647ddf880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0e8f0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0e8f0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0e8f0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0e8f0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x75f647c0e8f0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x75f647c0eda0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x75f647d4e830>, <class 'int'>: <function escape_int at 0x75f647d4e8c0>, <class 'float'>: <function escape_float at 0x75f647d4e950>, <class 'str'>: <function escape_str at 0x75f647d4eb90>, <class 'bytes'>: <function escape_bytes at 0x75f647d4eb00>, <class 'tuple'>: <function escape_sequence at 0x75f647d4e710>, <class 'list'>: <function escape_sequence at 0x75f647d4e710>, <class 'set'>: <function escape_sequence at 0x75f647d4e710>, <class 'frozenset'>: <function escape_sequence at 0x75f647d4e710>, <class 'dict'>: <function escape_dict at 0x75f647d4e680>, <class 'NoneType'>: <function escape_None at 0x75f647d4ec20>, <class 'datetime.date'>: <function escape_date at 0x75f647d4ee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x75f647d4edd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x75f647d4ecb0>, <class 'datetime.time'>: <function escape_time at 0x75f647d4ed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x75f647c0eda0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x75f647c0eda0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x91\x87\x96\n\x7f\x8d\x91G$:\xf6\xadQ\x0e\x97\x14\xd7\xc1\xc8\xef_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0583868'
      authresp = b'\x91\x87\x96\n\x7f\x8d\x91G$:\xf6\xadQ\x0e\x97\x14\xd7\xc1\xc8\xef'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0583868'
      k = b'_pid'
      v = b'83868'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x75f647c0eda0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x75f647c0f0a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x75f647c0f0a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x721a9a6ad120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x721a99b003a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x721a99b003a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x721a99b00430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x721a99b003a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x721a99b00430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x721a99b00430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x721a99b004c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x721a9a593640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x721a9a5d7880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x721a99b00550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x721a9a546830>, <class 'int'>: <function escape_int at 0x721a9a5468c0>, <class 'float'>: <function escape_float at 0x721a9a546950>, <class 'str'>: <function escape_str at 0x721a9a546b90>, <class 'bytes'>: <function escape_bytes at 0x721a9a546b00>, <class 'tuple'>: <function escape_sequence at 0x721a9a546710>, <class 'list'>: <function escape_sequence at 0x721a9a546710>, <class 'set'>: <function escape_sequence at 0x721a9a546710>, <class 'frozenset'>: <function escape_sequence at 0x721a9a546710>, <class 'dict'>: <function escape_dict at 0x721a9a546680>, <class 'NoneType'>: <function escape_None at 0x721a9a546c20>, <class 'datetime.date'>: <function escape_date at 0x721a9a546e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x721a9a546dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x721a9a546cb0>, <class 'datetime.time'>: <function escape_time at 0x721a9a546d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x721a99b00550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x721a99b00550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x94s\x08\r?\xa2bX\xe3/\x89\xaa\xf1n\xc6)\xa6\x8a\xe0H_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0547986'
      authresp = b'\x94s\x08\r?\xa2bX\xe3/\x89\xaa\xf1n\xc6)\xa6\x8a\xe0H'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0547986'
      k = b'_pid'
      v = b'47986'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x721a99b00550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x721a99b00ac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x721a99b00ac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x721a9a6ad120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x721a9a5b2e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x721a9a5b2e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x721a9a5b3460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x721a9a5b2e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x721a9a5b3460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x721a9a5b3460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a99b003a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x721a99b009d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x721a9a593640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x721a9a5d7880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a99b003a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a99b003a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a99b003a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a99b003a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a99b003a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x721a99b00a90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x721a9a546830>, <class 'int'>: <function escape_int at 0x721a9a5468c0>, <class 'float'>: <function escape_float at 0x721a9a546950>, <class 'str'>: <function escape_str at 0x721a9a546b90>, <class 'bytes'>: <function escape_bytes at 0x721a9a546b00>, <class 'tuple'>: <function escape_sequence at 0x721a9a546710>, <class 'list'>: <function escape_sequence at 0x721a9a546710>, <class 'set'>: <function escape_sequence at 0x721a9a546710>, <class 'frozenset'>: <function escape_sequence at 0x721a9a546710>, <class 'dict'>: <function escape_dict at 0x721a9a546680>, <class 'NoneType'>: <function escape_None at 0x721a9a546c20>, <class 'datetime.date'>: <function escape_date at 0x721a9a546e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x721a9a546dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x721a9a546cb0>, <class 'datetime.time'>: <function escape_time at 0x721a9a546d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x721a99b00a90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x721a99b00a90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xd3a\r\xf4\x05\x1e\xcb\xce\x94;\xe0\xd7\x91n<?\xa1\xea\xcdD_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0547986'
      authresp = b'\xd3a\r\xf4\x05\x1e\xcb\xce\x94;\xe0\xd7\x91n<?\xa1\xea\xcdD'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0547986'
      k = b'_pid'
      v = b'47986'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x721a99b00a90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x721a99b02440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x721a99b02440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x721a9a6ad120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x721a99b003a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x721a99b003a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x721a99b004c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x721a99b003a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x721a99b004c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x721a99b004c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x721a99b024d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x721a9a593640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x721a9a5d7880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x721a9a5b2e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x721a99b02440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x721a9a546830>, <class 'int'>: <function escape_int at 0x721a9a5468c0>, <class 'float'>: <function escape_float at 0x721a9a546950>, <class 'str'>: <function escape_str at 0x721a9a546b90>, <class 'bytes'>: <function escape_bytes at 0x721a9a546b00>, <class 'tuple'>: <function escape_sequence at 0x721a9a546710>, <class 'list'>: <function escape_sequence at 0x721a9a546710>, <class 'set'>: <function escape_sequence at 0x721a9a546710>, <class 'frozenset'>: <function escape_sequence at 0x721a9a546710>, <class 'dict'>: <function escape_dict at 0x721a9a546680>, <class 'NoneType'>: <function escape_None at 0x721a9a546c20>, <class 'datetime.date'>: <function escape_date at 0x721a9a546e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x721a9a546dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x721a9a546cb0>, <class 'datetime.time'>: <function escape_time at 0x721a9a546d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x721a99b02440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x721a99b02440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14-\x16\x111[\xbe\x1dz\xde\xfds\x85d\x90\x10\x87+~\xbd\xd1_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0547986'
      authresp = b'-\x16\x111[\xbe\x1dz\xde\xfds\x85d\x90\x10\x87+~\xbd\xd1'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0547986'
      k = b'_pid'
      v = b'47986'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x721a99b02440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x721a99b024a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x721a99b024a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7683540a5120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x768353fbc3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x768353fbc3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x768353fbc430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x768353fbc3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x768353fbc430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x768353fbc430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x768353fbc4c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x768353f4f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x768353f93880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x768353fbc550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x768353f02830>, <class 'int'>: <function escape_int at 0x768353f028c0>, <class 'float'>: <function escape_float at 0x768353f02950>, <class 'str'>: <function escape_str at 0x768353f02b90>, <class 'bytes'>: <function escape_bytes at 0x768353f02b00>, <class 'tuple'>: <function escape_sequence at 0x768353f02710>, <class 'list'>: <function escape_sequence at 0x768353f02710>, <class 'set'>: <function escape_sequence at 0x768353f02710>, <class 'frozenset'>: <function escape_sequence at 0x768353f02710>, <class 'dict'>: <function escape_dict at 0x768353f02680>, <class 'NoneType'>: <function escape_None at 0x768353f02c20>, <class 'datetime.date'>: <function escape_date at 0x768353f02e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x768353f02dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x768353f02cb0>, <class 'datetime.time'>: <function escape_time at 0x768353f02d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x768353fbc550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x768353fbc550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b"\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14'\x1b1ZSm\x82$UB\x84>\x0b|\xf4\xaeAw\xe9N_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0537365"
      authresp = b"'\x1b1ZSm\x82$UB\x84>\x0b|\xf4\xaeAw\xe9N"
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0537365'
      k = b'_pid'
      v = b'37365'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x768353fbc550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x768353fbcac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x768353fbcac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7683540a5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x768353f6ee60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x768353f6ee60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x768353f6f460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x768353f6ee60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x768353f6f460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x768353f6f460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353fbc3a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x768353fbc9d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x768353f4f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x768353f93880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353fbc3a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353fbc3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353fbc3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353fbc3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353fbc3a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x768353fbca90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x768353f02830>, <class 'int'>: <function escape_int at 0x768353f028c0>, <class 'float'>: <function escape_float at 0x768353f02950>, <class 'str'>: <function escape_str at 0x768353f02b90>, <class 'bytes'>: <function escape_bytes at 0x768353f02b00>, <class 'tuple'>: <function escape_sequence at 0x768353f02710>, <class 'list'>: <function escape_sequence at 0x768353f02710>, <class 'set'>: <function escape_sequence at 0x768353f02710>, <class 'frozenset'>: <function escape_sequence at 0x768353f02710>, <class 'dict'>: <function escape_dict at 0x768353f02680>, <class 'NoneType'>: <function escape_None at 0x768353f02c20>, <class 'datetime.date'>: <function escape_date at 0x768353f02e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x768353f02dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x768353f02cb0>, <class 'datetime.time'>: <function escape_time at 0x768353f02d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x768353fbca90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x768353fbca90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14)\xef2\x99\xd1&\xd6P.\xc9O>\x9bI\xcbu\x13\x82\r\xb1_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0537365'
      authresp = b')\xef2\x99\xd1&\xd6P.\xc9O>\x9bI\xcbu\x13\x82\r\xb1'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0537365'
      k = b'_pid'
      v = b'37365'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x768353fbca90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x768353fbe440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x768353fbe440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7683540a5120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x768353fbc3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x768353fbc3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x768353fbc4c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x768353fbc3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x768353fbc4c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x768353fbc4c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x768353fbe4d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x768353f4f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x768353f93880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x768353f6ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x768353fbe440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x768353f02830>, <class 'int'>: <function escape_int at 0x768353f028c0>, <class 'float'>: <function escape_float at 0x768353f02950>, <class 'str'>: <function escape_str at 0x768353f02b90>, <class 'bytes'>: <function escape_bytes at 0x768353f02b00>, <class 'tuple'>: <function escape_sequence at 0x768353f02710>, <class 'list'>: <function escape_sequence at 0x768353f02710>, <class 'set'>: <function escape_sequence at 0x768353f02710>, <class 'frozenset'>: <function escape_sequence at 0x768353f02710>, <class 'dict'>: <function escape_dict at 0x768353f02680>, <class 'NoneType'>: <function escape_None at 0x768353f02c20>, <class 'datetime.date'>: <function escape_date at 0x768353f02e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x768353f02dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x768353f02cb0>, <class 'datetime.time'>: <function escape_time at 0x768353f02d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x768353fbe440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x768353fbe440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x9c\xd1]\xde\x91\xf1\xfb8\x1c\xd5v\xf9V\xce\x05s\x99\xbb\xd0\x07_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0537365'
      authresp = b'\x9c\xd1]\xde\x91\xf1\xfb8\x1c\xd5v\xf9V\xce\x05s\x99\xbb\xd0\x07'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0537365'
      k = b'_pid'
      v = b'37365'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x768353fbe440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x768353fbe4a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x768353fbe4a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x78d525699120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78d5255ec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78d5255ec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78d5255ec430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78d5255ec3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78d5255ec430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78d5255ec430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x78d5255ec4c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x78d52557f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x78d5255c3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x78d5255ec550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x78d525532830>, <class 'int'>: <function escape_int at 0x78d5255328c0>, <class 'float'>: <function escape_float at 0x78d525532950>, <class 'str'>: <function escape_str at 0x78d525532b90>, <class 'bytes'>: <function escape_bytes at 0x78d525532b00>, <class 'tuple'>: <function escape_sequence at 0x78d525532710>, <class 'list'>: <function escape_sequence at 0x78d525532710>, <class 'set'>: <function escape_sequence at 0x78d525532710>, <class 'frozenset'>: <function escape_sequence at 0x78d525532710>, <class 'dict'>: <function escape_dict at 0x78d525532680>, <class 'NoneType'>: <function escape_None at 0x78d525532c20>, <class 'datetime.date'>: <function escape_date at 0x78d525532e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x78d525532dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x78d525532cb0>, <class 'datetime.time'>: <function escape_time at 0x78d525532d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x78d5255ec550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x78d5255ec550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xbav\x9b|:L\x92\xff+\x9e^\xe5^\x90\xb8\xa2 \x01\x82\x89_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0591619'
      authresp = b'\xbav\x9b|:L\x92\xff+\x9e^\xe5^\x90\xb8\xa2 \x01\x82\x89'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0591619'
      k = b'_pid'
      v = b'91619'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x78d5255ec550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x78d5255ecac0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x78d5255ecac0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x78d525699120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78d52559ee60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78d52559ee60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78d52559f460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78d52559ee60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78d52559f460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78d52559f460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d5255ec3a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x78d5255ec9d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x78d52557f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x78d5255c3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d5255ec3a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d5255ec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d5255ec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d5255ec3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d5255ec3a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x78d5255eca90>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x78d525532830>, <class 'int'>: <function escape_int at 0x78d5255328c0>, <class 'float'>: <function escape_float at 0x78d525532950>, <class 'str'>: <function escape_str at 0x78d525532b90>, <class 'bytes'>: <function escape_bytes at 0x78d525532b00>, <class 'tuple'>: <function escape_sequence at 0x78d525532710>, <class 'list'>: <function escape_sequence at 0x78d525532710>, <class 'set'>: <function escape_sequence at 0x78d525532710>, <class 'frozenset'>: <function escape_sequence at 0x78d525532710>, <class 'dict'>: <function escape_dict at 0x78d525532680>, <class 'NoneType'>: <function escape_None at 0x78d525532c20>, <class 'datetime.date'>: <function escape_date at 0x78d525532e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x78d525532dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x78d525532cb0>, <class 'datetime.time'>: <function escape_time at 0x78d525532d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x78d5255eca90>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x78d5255eca90>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xfaY:\xb2\x1c\x02\x1a\xc4\xfe\xdc\x85\x93X\xa9QW\xaa\xe2\x7f\xed_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0591619'
      authresp = b'\xfaY:\xb2\x1c\x02\x1a\xc4\xfe\xdc\x85\x93X\xa9QW\xaa\xe2\x7f\xed'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0591619'
      k = b'_pid'
      v = b'91619'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x78d5255eca90>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x78d5255ee440>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x78d5255ee440>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x78d525699120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78d5255ec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78d5255ec3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78d5255ec4c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78d5255ec3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78d5255ec4c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78d5255ec4c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x78d5255ee4d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x78d52557f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x78d5255c3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78d52559ee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x78d5255ee440>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x78d525532830>, <class 'int'>: <function escape_int at 0x78d5255328c0>, <class 'float'>: <function escape_float at 0x78d525532950>, <class 'str'>: <function escape_str at 0x78d525532b90>, <class 'bytes'>: <function escape_bytes at 0x78d525532b00>, <class 'tuple'>: <function escape_sequence at 0x78d525532710>, <class 'list'>: <function escape_sequence at 0x78d525532710>, <class 'set'>: <function escape_sequence at 0x78d525532710>, <class 'frozenset'>: <function escape_sequence at 0x78d525532710>, <class 'dict'>: <function escape_dict at 0x78d525532680>, <class 'NoneType'>: <function escape_None at 0x78d525532c20>, <class 'datetime.date'>: <function escape_date at 0x78d525532e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x78d525532dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x78d525532cb0>, <class 'datetime.time'>: <function escape_time at 0x78d525532d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x78d5255ee440>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x78d5255ee440>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14"\xce\x10G\x0c}P\x1dW\xc37%\x0b\xc8\xdc\x03&^%D_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0591619'
      authresp = b'"\xce\x10G\x0c}P\x1dW\xc37%\x0b\xc8\xdc\x03&^%D'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0591619'
      k = b'_pid'
      v = b'91619'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x78d5255ee440>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x78d5255ee4a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x78d5255ee4a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x73a76f7a1120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73a76edf86d0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73a76edf86d0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73a76edf8760>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73a76edf86d0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73a76edf8760>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73a76edf8760>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76eda70d0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x73a76edf8850>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x73a76ed87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x73a76edcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76eda70d0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76eda70d0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76eda70d0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76eda70d0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76eda70d0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x73a76edf89a0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x73a76ed3a830>, <class 'int'>: <function escape_int at 0x73a76ed3a8c0>, <class 'float'>: <function escape_float at 0x73a76ed3a950>, <class 'str'>: <function escape_str at 0x73a76ed3ab90>, <class 'bytes'>: <function escape_bytes at 0x73a76ed3ab00>, <class 'tuple'>: <function escape_sequence at 0x73a76ed3a710>, <class 'list'>: <function escape_sequence at 0x73a76ed3a710>, <class 'set'>: <function escape_sequence at 0x73a76ed3a710>, <class 'frozenset'>: <function escape_sequence at 0x73a76ed3a710>, <class 'dict'>: <function escape_dict at 0x73a76ed3a680>, <class 'NoneType'>: <function escape_None at 0x73a76ed3ac20>, <class 'datetime.date'>: <function escape_date at 0x73a76ed3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x73a76ed3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x73a76ed3acb0>, <class 'datetime.time'>: <function escape_time at 0x73a76ed3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x73a76edf89a0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x73a76edf89a0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14?\x1e\xd2\x95}\xa6=\xfa\xb8\x81\xf3A\x19C\x8d\xcc\xd2\xb0\xd3,_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0598683'
      authresp = b'?\x1e\xd2\x95}\xa6=\xfa\xb8\x81\xf3A\x19C\x8d\xcc\xd2\xb0\xd3,'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0598683'
      k = b'_pid'
      v = b'98683'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x73a76edf89a0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x73a76edf8f10>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x73a76edf8f10>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x73a76f7a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73a76edf8f10>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73a76edf8f10>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73a76edfae90>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73a76edf8f10>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73a76edfae90>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73a76edfae90>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edf89a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x73a76edfa980>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x73a76ed87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x73a76edcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edf89a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edf89a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edf89a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edf89a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edf89a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x73a76edfa8f0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x73a76ed3a830>, <class 'int'>: <function escape_int at 0x73a76ed3a8c0>, <class 'float'>: <function escape_float at 0x73a76ed3a950>, <class 'str'>: <function escape_str at 0x73a76ed3ab90>, <class 'bytes'>: <function escape_bytes at 0x73a76ed3ab00>, <class 'tuple'>: <function escape_sequence at 0x73a76ed3a710>, <class 'list'>: <function escape_sequence at 0x73a76ed3a710>, <class 'set'>: <function escape_sequence at 0x73a76ed3a710>, <class 'frozenset'>: <function escape_sequence at 0x73a76ed3a710>, <class 'dict'>: <function escape_dict at 0x73a76ed3a680>, <class 'NoneType'>: <function escape_None at 0x73a76ed3ac20>, <class 'datetime.date'>: <function escape_date at 0x73a76ed3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x73a76ed3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x73a76ed3acb0>, <class 'datetime.time'>: <function escape_time at 0x73a76ed3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x73a76edfa8f0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x73a76edfa8f0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x149\x98.\xa5GQ\x99\xe5|T\xb7\xbc%\xff\x02j\xd8\xf6\xcf}_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0598683'
      authresp = b'9\x98.\xa5GQ\x99\xe5|T\xb7\xbc%\xff\x02j\xd8\xf6\xcf}'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0598683'
      k = b'_pid'
      v = b'98683'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x73a76edfa8f0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x73a76edfac80>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x73a76edfac80>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x73a76f7a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73a76edfac80>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73a76edfac80>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73a76edfa860>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x73a76edfac80>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73a76edfa860>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x73a76edfa860>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edfa8f0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x73a76edfaa70>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x73a76ed87640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x73a76edcb880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edfa8f0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edfa8f0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edfa8f0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edfa8f0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x73a76edfa8f0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x73a76edfada0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x73a76ed3a830>, <class 'int'>: <function escape_int at 0x73a76ed3a8c0>, <class 'float'>: <function escape_float at 0x73a76ed3a950>, <class 'str'>: <function escape_str at 0x73a76ed3ab90>, <class 'bytes'>: <function escape_bytes at 0x73a76ed3ab00>, <class 'tuple'>: <function escape_sequence at 0x73a76ed3a710>, <class 'list'>: <function escape_sequence at 0x73a76ed3a710>, <class 'set'>: <function escape_sequence at 0x73a76ed3a710>, <class 'frozenset'>: <function escape_sequence at 0x73a76ed3a710>, <class 'dict'>: <function escape_dict at 0x73a76ed3a680>, <class 'NoneType'>: <function escape_None at 0x73a76ed3ac20>, <class 'datetime.date'>: <function escape_date at 0x73a76ed3ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x73a76ed3add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x73a76ed3acb0>, <class 'datetime.time'>: <function escape_time at 0x73a76ed3ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x73a76edfada0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x73a76edfada0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x9c\x00\xaa\xa4\x91\x11-\x91A\x95\xbc\xe8\xb6\x95\xce\xd9\xba\xcck<_be61cf5335d3ad96\x00mysql_native_password\x006\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0598683'
      authresp = b'\x9c\x00\xaa\xa4\x91\x11-\x91A\x95\xbc\xe8\xb6\x95\xce\xd9\xba\xcck<'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x0598683'
      k = b'_pid'
      v = b'98683'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x73a76edfada0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x73a76edfb0a0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x73a76edfb0a0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x78b7072ad120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b7067043a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b7067043a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b706704430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b7067043a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b706704430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b706704430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x78b7067044c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x78b707157640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x78b70719b880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x78b706704550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x78b70710a830>, <class 'int'>: <function escape_int at 0x78b70710a8c0>, <class 'float'>: <function escape_float at 0x78b70710a950>, <class 'str'>: <function escape_str at 0x78b70710ab90>, <class 'bytes'>: <function escape_bytes at 0x78b70710ab00>, <class 'tuple'>: <function escape_sequence at 0x78b70710a710>, <class 'list'>: <function escape_sequence at 0x78b70710a710>, <class 'set'>: <function escape_sequence at 0x78b70710a710>, <class 'frozenset'>: <function escape_sequence at 0x78b70710a710>, <class 'dict'>: <function escape_dict at 0x78b70710a680>, <class 'NoneType'>: <function escape_None at 0x78b70710ac20>, <class 'datetime.date'>: <function escape_date at 0x78b70710ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x78b70710add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x78b70710acb0>, <class 'datetime.time'>: <function escape_time at 0x78b70710ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x78b706704550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x78b706704550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xfe\xb1\x85\x00\x80\xedM($\xf9\x15\x86\x08\xe0|\xf1C8\\\x81_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06125747'
      authresp = b'\xfe\xb1\x85\x00\x80\xedM($\xf9\x15\x86\x08\xe0|\xf1C8\\\x81'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06125747'
      k = b'_pid'
      v = b'125747'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x78b706704550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x78b706704af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x78b706704af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x78b7072ad120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b707176e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b707176e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b707177460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b707176e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b707177460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b707177460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7067043a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x78b7067049d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x78b707157640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x78b70719b880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7067043a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7067043a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7067043a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7067043a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b7067043a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x78b706704ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x78b70710a830>, <class 'int'>: <function escape_int at 0x78b70710a8c0>, <class 'float'>: <function escape_float at 0x78b70710a950>, <class 'str'>: <function escape_str at 0x78b70710ab90>, <class 'bytes'>: <function escape_bytes at 0x78b70710ab00>, <class 'tuple'>: <function escape_sequence at 0x78b70710a710>, <class 'list'>: <function escape_sequence at 0x78b70710a710>, <class 'set'>: <function escape_sequence at 0x78b70710a710>, <class 'frozenset'>: <function escape_sequence at 0x78b70710a710>, <class 'dict'>: <function escape_dict at 0x78b70710a680>, <class 'NoneType'>: <function escape_None at 0x78b70710ac20>, <class 'datetime.date'>: <function escape_date at 0x78b70710ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x78b70710add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x78b70710acb0>, <class 'datetime.time'>: <function escape_time at 0x78b70710ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x78b706704ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x78b706704ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\x15\x8ewj@S#\xce\x1a_\xf3\xf8I\t\x14\xd1\xb2;\x95R_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06125747'
      authresp = b'\x15\x8ewj@S#\xce\x1a_\xf3\xf8I\t\x14\xd1\xb2;\x95R'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06125747'
      k = b'_pid'
      v = b'125747'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x78b706704ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x78b706706470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x78b706706470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x78b7072ad120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b7067043a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b7067043a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b7067044c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x78b7067043a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b7067044c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x78b7067044c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x78b706706500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x78b707157640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x78b70719b880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x78b707176e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x78b706706470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x78b70710a830>, <class 'int'>: <function escape_int at 0x78b70710a8c0>, <class 'float'>: <function escape_float at 0x78b70710a950>, <class 'str'>: <function escape_str at 0x78b70710ab90>, <class 'bytes'>: <function escape_bytes at 0x78b70710ab00>, <class 'tuple'>: <function escape_sequence at 0x78b70710a710>, <class 'list'>: <function escape_sequence at 0x78b70710a710>, <class 'set'>: <function escape_sequence at 0x78b70710a710>, <class 'frozenset'>: <function escape_sequence at 0x78b70710a710>, <class 'dict'>: <function escape_dict at 0x78b70710a680>, <class 'NoneType'>: <function escape_None at 0x78b70710ac20>, <class 'datetime.date'>: <function escape_date at 0x78b70710ae60>, <class 'datetime.datetime'>: <function escape_datetime at 0x78b70710add0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x78b70710acb0>, <class 'datetime.time'>: <function escape_time at 0x78b70710ad40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x78b706706470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x78b706706470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xa1\x80\xee\x8c\xce\xf3.}F\xf3\xd4\xa0\xfc\xf0\xaa\xf7\\\x86BZ_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06125747'
      authresp = b'\xa1\x80\xee\x8c\xce\xf3.}F\xf3\xd4\xa0\xfc\xf0\xaa\xf7\\\x86BZ'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06125747'
      k = b'_pid'
      v = b'125747'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x78b706706470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x78b7067064d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x78b7067064d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7dfd126b9120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7dfd11b0c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7dfd11b0c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7dfd11b0c430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7dfd11b0c3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7dfd11b0c430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7dfd11b0c430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7dfd11b0c4c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7dfd1259f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7dfd125e3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7dfd11b0c550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7dfd12552830>, <class 'int'>: <function escape_int at 0x7dfd125528c0>, <class 'float'>: <function escape_float at 0x7dfd12552950>, <class 'str'>: <function escape_str at 0x7dfd12552b90>, <class 'bytes'>: <function escape_bytes at 0x7dfd12552b00>, <class 'tuple'>: <function escape_sequence at 0x7dfd12552710>, <class 'list'>: <function escape_sequence at 0x7dfd12552710>, <class 'set'>: <function escape_sequence at 0x7dfd12552710>, <class 'frozenset'>: <function escape_sequence at 0x7dfd12552710>, <class 'dict'>: <function escape_dict at 0x7dfd12552680>, <class 'NoneType'>: <function escape_None at 0x7dfd12552c20>, <class 'datetime.date'>: <function escape_date at 0x7dfd12552e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7dfd12552dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7dfd12552cb0>, <class 'datetime.time'>: <function escape_time at 0x7dfd12552d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7dfd11b0c550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7dfd11b0c550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xbd\xa8O\x81,a\xf8c\x1a\xd9\x05n\x02\x95!r[//\x97_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06160267'
      authresp = b'\xbd\xa8O\x81,a\xf8c\x1a\xd9\x05n\x02\x95!r[//\x97'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06160267'
      k = b'_pid'
      v = b'160267'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7dfd11b0c550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7dfd11b0caf0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7dfd11b0caf0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7dfd126b9120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7dfd125bee60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7dfd125bee60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7dfd125bf460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7dfd125bee60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7dfd125bf460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7dfd125bf460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd11b0c3a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7dfd11b0c9d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7dfd1259f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7dfd125e3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd11b0c3a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd11b0c3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd11b0c3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd11b0c3a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd11b0c3a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7dfd11b0cac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7dfd12552830>, <class 'int'>: <function escape_int at 0x7dfd125528c0>, <class 'float'>: <function escape_float at 0x7dfd12552950>, <class 'str'>: <function escape_str at 0x7dfd12552b90>, <class 'bytes'>: <function escape_bytes at 0x7dfd12552b00>, <class 'tuple'>: <function escape_sequence at 0x7dfd12552710>, <class 'list'>: <function escape_sequence at 0x7dfd12552710>, <class 'set'>: <function escape_sequence at 0x7dfd12552710>, <class 'frozenset'>: <function escape_sequence at 0x7dfd12552710>, <class 'dict'>: <function escape_dict at 0x7dfd12552680>, <class 'NoneType'>: <function escape_None at 0x7dfd12552c20>, <class 'datetime.date'>: <function escape_date at 0x7dfd12552e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7dfd12552dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7dfd12552cb0>, <class 'datetime.time'>: <function escape_time at 0x7dfd12552d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7dfd11b0cac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7dfd11b0cac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xab\xd8\xb31\xa4\xfc\xe4\xc1\xbf\xfc\x0b\x99\xd3\xab\xfc+\xcb\x04P\x8f_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06160267'
      authresp = b'\xab\xd8\xb31\xa4\xfc\xe4\xc1\xbf\xfc\x0b\x99\xd3\xab\xfc+\xcb\x04P\x8f'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06160267'
      k = b'_pid'
      v = b'160267'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7dfd11b0cac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7dfd11b0e470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7dfd11b0e470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7dfd126b9120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7dfd11b0c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7dfd11b0c3a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7dfd11b0c4c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7dfd11b0c3a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7dfd11b0c4c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7dfd11b0c4c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7dfd11b0e500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7dfd1259f640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7dfd125e3880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7dfd125bee60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7dfd11b0e470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7dfd12552830>, <class 'int'>: <function escape_int at 0x7dfd125528c0>, <class 'float'>: <function escape_float at 0x7dfd12552950>, <class 'str'>: <function escape_str at 0x7dfd12552b90>, <class 'bytes'>: <function escape_bytes at 0x7dfd12552b00>, <class 'tuple'>: <function escape_sequence at 0x7dfd12552710>, <class 'list'>: <function escape_sequence at 0x7dfd12552710>, <class 'set'>: <function escape_sequence at 0x7dfd12552710>, <class 'frozenset'>: <function escape_sequence at 0x7dfd12552710>, <class 'dict'>: <function escape_dict at 0x7dfd12552680>, <class 'NoneType'>: <function escape_None at 0x7dfd12552c20>, <class 'datetime.date'>: <function escape_date at 0x7dfd12552e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7dfd12552dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7dfd12552cb0>, <class 'datetime.time'>: <function escape_time at 0x7dfd12552d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7dfd11b0e470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7dfd11b0e470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xe3P\xd3\x9a\xb6\x0f\xa6t\x1f\xc0\xda\xdc\xbb\x14\x04\xe8\xc6;z\x9f_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06160267'
      authresp = b'\xe3P\xd3\x9a\xb6\x0f\xa6t\x1f\xc0\xda\xdc\xbb\x14\x04\xe8\xc6;z\x9f'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06160267'
      k = b'_pid'
      v = b'160267'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7dfd11b0e470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7dfd11b0e4d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7dfd11b0e4d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7802710a1120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780270fb83a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780270fb83a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780270fb8430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780270fb83a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780270fb8430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780270fb8430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x780270fb84c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x780270f4b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x780270f8f880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x780270fb8550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x780270efe830>, <class 'int'>: <function escape_int at 0x780270efe8c0>, <class 'float'>: <function escape_float at 0x780270efe950>, <class 'str'>: <function escape_str at 0x780270efeb90>, <class 'bytes'>: <function escape_bytes at 0x780270efeb00>, <class 'tuple'>: <function escape_sequence at 0x780270efe710>, <class 'list'>: <function escape_sequence at 0x780270efe710>, <class 'set'>: <function escape_sequence at 0x780270efe710>, <class 'frozenset'>: <function escape_sequence at 0x780270efe710>, <class 'dict'>: <function escape_dict at 0x780270efe680>, <class 'NoneType'>: <function escape_None at 0x780270efec20>, <class 'datetime.date'>: <function escape_date at 0x780270efee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x780270efedd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x780270efecb0>, <class 'datetime.time'>: <function escape_time at 0x780270efed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x780270fb8550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x780270fb8550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14N^(\x9a\xcfZ\x15\xeb\x15\x1b\xbfR"\xd8m<\x02\xb1\xd3\xee_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06171096'
      authresp = b'N^(\x9a\xcfZ\x15\xeb\x15\x1b\xbfR"\xd8m<\x02\xb1\xd3\xee'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06171096'
      k = b'_pid'
      v = b'171096'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x780270fb8550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x780270fb8af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x780270fb8af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7802710a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780270f6ae60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780270f6ae60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780270f6b460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780270f6ae60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780270f6b460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780270f6b460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270fb83a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x780270fb89d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x780270f4b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x780270f8f880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270fb83a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270fb83a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270fb83a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270fb83a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270fb83a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x780270fb8ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x780270efe830>, <class 'int'>: <function escape_int at 0x780270efe8c0>, <class 'float'>: <function escape_float at 0x780270efe950>, <class 'str'>: <function escape_str at 0x780270efeb90>, <class 'bytes'>: <function escape_bytes at 0x780270efeb00>, <class 'tuple'>: <function escape_sequence at 0x780270efe710>, <class 'list'>: <function escape_sequence at 0x780270efe710>, <class 'set'>: <function escape_sequence at 0x780270efe710>, <class 'frozenset'>: <function escape_sequence at 0x780270efe710>, <class 'dict'>: <function escape_dict at 0x780270efe680>, <class 'NoneType'>: <function escape_None at 0x780270efec20>, <class 'datetime.date'>: <function escape_date at 0x780270efee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x780270efedd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x780270efecb0>, <class 'datetime.time'>: <function escape_time at 0x780270efed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x780270fb8ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x780270fb8ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14m\x04\x9fE\x1c\xe5C\x92\xf8>$\xc1\xbf\xa7\xf6u\x86\xc8\x0c\xda_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06171096'
      authresp = b'm\x04\x9fE\x1c\xe5C\x92\xf8>$\xc1\xbf\xa7\xf6u\x86\xc8\x0c\xda'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06171096'
      k = b'_pid'
      v = b'171096'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x780270fb8ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x780270fba470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x780270fba470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7802710a1120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780270fb83a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780270fb83a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780270fb84c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x780270fb83a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780270fb84c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x780270fb84c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x780270fba500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x780270f4b640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x780270f8f880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x780270f6ae60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x780270fba470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x780270efe830>, <class 'int'>: <function escape_int at 0x780270efe8c0>, <class 'float'>: <function escape_float at 0x780270efe950>, <class 'str'>: <function escape_str at 0x780270efeb90>, <class 'bytes'>: <function escape_bytes at 0x780270efeb00>, <class 'tuple'>: <function escape_sequence at 0x780270efe710>, <class 'list'>: <function escape_sequence at 0x780270efe710>, <class 'set'>: <function escape_sequence at 0x780270efe710>, <class 'frozenset'>: <function escape_sequence at 0x780270efe710>, <class 'dict'>: <function escape_dict at 0x780270efe680>, <class 'NoneType'>: <function escape_None at 0x780270efec20>, <class 'datetime.date'>: <function escape_date at 0x780270efee60>, <class 'datetime.datetime'>: <function escape_datetime at 0x780270efedd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x780270efecb0>, <class 'datetime.time'>: <function escape_time at 0x780270efed40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x780270fba470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x780270fba470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14L\x9e\x01\xfd}\x98\xc4p:\xa7\xa8\x02\xeb\xca\xadC&_\xbcN_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06171096'
      authresp = b'L\x9e\x01\xfd}\x98\xc4p:\xa7\xa8\x02\xeb\xca\xadC&_\xbcN'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06171096'
      k = b'_pid'
      v = b'171096'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x780270fba470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x780270fba4d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x780270fba4d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7260c57ad120>
      exit_code = 0
      rollback_callback = None
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7260c4c003a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7260c4c003a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7260c4c00430>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7260c4c003a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7260c4c00430>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7260c4c00430>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7260c4c004c0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7260c4d93640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7260c4dd7880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7260c4c00550>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7260c4d46830>, <class 'int'>: <function escape_int at 0x7260c4d468c0>, <class 'float'>: <function escape_float at 0x7260c4d46950>, <class 'str'>: <function escape_str at 0x7260c4d46b90>, <class 'bytes'>: <function escape_bytes at 0x7260c4d46b00>, <class 'tuple'>: <function escape_sequence at 0x7260c4d46710>, <class 'list'>: <function escape_sequence at 0x7260c4d46710>, <class 'set'>: <function escape_sequence at 0x7260c4d46710>, <class 'frozenset'>: <function escape_sequence at 0x7260c4d46710>, <class 'dict'>: <function escape_dict at 0x7260c4d46680>, <class 'NoneType'>: <function escape_None at 0x7260c4d46c20>, <class 'datetime.date'>: <function escape_date at 0x7260c4d46e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7260c4d46dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7260c4d46cb0>, <class 'datetime.time'>: <function escape_time at 0x7260c4d46d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7260c4c00550>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7260c4c00550>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xb9\rJo;\x93c\x94\xf8l\x0eXr\xdacW\x89\x80\xa7C_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06176695'
      authresp = b'\xb9\rJo;\x93c\x94\xf8l\x0eXr\xdacW\x89\x80\xa7C'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06176695'
      k = b'_pid'
      v = b'176695'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7260c4c00550>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7260c4c00af0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7260c4c00af0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.local. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7260c57ad120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.local'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7260c4db2e60>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7260c4db2e60>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7260c4db3460>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7260c4db2e60>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7260c4db3460>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7260c4db3460>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4c003a0>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7260c4c009d0>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7260c4d93640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7260c4dd7880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4c003a0>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4c003a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4c003a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4c003a0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4c003a0>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7260c4c00ac0>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7260c4d46830>, <class 'int'>: <function escape_int at 0x7260c4d468c0>, <class 'float'>: <function escape_float at 0x7260c4d46950>, <class 'str'>: <function escape_str at 0x7260c4d46b90>, <class 'bytes'>: <function escape_bytes at 0x7260c4d46b00>, <class 'tuple'>: <function escape_sequence at 0x7260c4d46710>, <class 'list'>: <function escape_sequence at 0x7260c4d46710>, <class 'set'>: <function escape_sequence at 0x7260c4d46710>, <class 'frozenset'>: <function escape_sequence at 0x7260c4d46710>, <class 'dict'>: <function escape_dict at 0x7260c4d46680>, <class 'NoneType'>: <function escape_None at 0x7260c4d46c20>, <class 'datetime.date'>: <function escape_date at 0x7260c4d46e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7260c4d46dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7260c4d46cb0>, <class 'datetime.time'>: <function escape_time at 0x7260c4d46d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7260c4c00ac0>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7260c4c00ac0>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14J\x96\xd1\xe0Q\x05Y\xc2\x89&eY\xe5\x07W\xd4\xe2\xda\x96\xcf_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06176695'
      authresp = b'J\x96\xd1\xe0Q\x05Y\xc2\x89&eY\xe5\x07W\xd4\xe2\xda\x96\xcf'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06176695'
      k = b'_pid'
      v = b'176695'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7260c4c00ac0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7260c4c02470>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7260c4c02470>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
Backup failed for Site ozerpan.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 869, in backup
    odb = scheduled_backup(
      context = CliCtxObj(sites=['ozerpan', 'ozerpan.local', 'ozerpan.test'], force=False, profile=False, verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x7260c57ad120>
      exit_code = 1
      rollback_callback = None
      site = 'ozerpan.test'
  File "apps/frappe/frappe/utils/backups.py", line 577, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7260c4c003a0>
  File "apps/frappe/frappe/utils/backups.py", line 614, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7260c4c003a0>
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7260c4c004c0>
      db_name = '_be61cf5335d3ad96'
      user = '_be61cf5335d3ad96'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = <frappe.utils.CallbackManager object at 0x7260c4c003a0>
      site = 'ozerpan'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7260c4c004c0>
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = <frappe.utils.backups.BackupGenerator object at 0x7260c4c004c0>
  File "apps/frappe/frappe/database/mariadb/database.py", line 468, in get_tables
    frappe.qb.from_(information_schema.tables)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
      cached = True
      to_query = True
      tables = None
      information_schema = <pypika.queries.Schema object at 0x7260c4c02500>
  File "apps/frappe/frappe/query_builder/utils.py", line 84, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = []
      params = {'param1': 'information_schema'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7260c4d93640>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7260c4dd7880>
  File "apps/frappe/frappe/database/database.py", line 213, in sql
    self.connect()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`<>%(param1)s'
      values = {'param1': 'information_schema'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
  File "apps/frappe/frappe/database/database.py", line 118, in connect
    self._conn: "MariadbConnection" | "PostgresConnection" = self.get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 107, in get_connection
    conn = self._get_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 113, in _get_connection
    return self.create_connection()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
  File "apps/frappe/frappe/database/mariadb/database.py", line 116, in create_connection
    return pymysql.connect(**self.get_connection_settings())
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7260c4db2e60>
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
      self = <pymysql.connections.Connection object at 0x7260c4c02470>
      user = '_be61cf5335d3ad96'
      password = ********
      host = '127.0.0.1'
      database = '_be61cf5335d3ad96'
      unix_socket = None
      port = 3306
      charset = 'utf8mb4'
      collation = None
      sql_mode = None
      read_default_file = None
      conv = {<class 'bool'>: <function escape_bool at 0x7260c4d46830>, <class 'int'>: <function escape_int at 0x7260c4d468c0>, <class 'float'>: <function escape_float at 0x7260c4d46950>, <class 'str'>: <function escape_str at 0x7260c4d46b90>, <class 'bytes'>: <function escape_bytes at 0x7260c4d46b00>, <class 'tuple'>: <function escape_sequence at 0x7260c4d46710>, <class 'list'>: <function escape_sequence at 0x7260c4d46710>, <class 'set'>: <function escape_sequence at 0x7260c4d46710>, <class 'frozenset'>: <function escape_sequence at 0x7260c4d46710>, <class 'dict'>: <function escape_dict at 0x7260c4d46680>, <class 'NoneType'>: <function escape_None at 0x7260c4d46c20>, <class 'datetime.date'>: <function escape_date at 0x7260c4d46e60>, <class 'datetime.datetime'>: <function escape_datetime at 0x7260c4d46dd0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x7260c4d46cb0>, <class 'datetime.time'>: <function escape_time at 0x7260c4d46d40>, <class 'time.struct_time'>: <function escape_struc...
      use_unicode = True
      client_flag = 3842573
      cursorclass = <class 'pymysql.cursors.Cursor'>
      init_command = None
      connect_timeout = 10
      autocommit = False
      local_infile = False
      max_allowed_packet = 16777216
      defer_connect = False
      auth_plugin_map = None
      read_timeout = None
      write_timeout = None
      bind_address = None
      binary_prefix = False
      program_name = None
      server_public_key = ********
      ssl = None
      ssl_ca = None
      ssl_cert = None
      ssl_disabled = None
      ssl_key = ********
      ssl_key_password = ********
      ssl_verify_cert = None
      ssl_verify_identity = None
      compress = None
      named_pipe = None
      passwd = ********
      db = None
      read_default_group = None
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 669, in connect
    self._request_authentication()
      self = <pymysql.connections.Connection object at 0x7260c4c02470>
      sock = <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
      kwargs = {}
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 957, in _request_authentication
    auth_packet = self._read_packet()
      self = <pymysql.connections.Connection object at 0x7260c4c02470>
      charset_id = 45
      data_init = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
      data = b'\r\xa2:\x00\xff\xff\xff\x00-\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_be61cf5335d3ad96\x00\x14\xefE5\r\xde\xa2F^g\xc3$P92\xd5\xcbs\x05\x04\x87_be61cf5335d3ad96\x00mysql_native_password\x007\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06176695'
      authresp = b'\xefE5\r\xde\xa2F^g\xc3$P92\xd5\xcbs\x05\x04\x87'
      plugin_name = b'mysql_native_password'
      connect_attrs = b'\x0c_client_name\x07pymysql\x0f_client_version\x051.1.1\x04_pid\x06176695'
      k = b'_pid'
      v = b'176695'
  File "env/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7260c4c02470>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b"\xff\x19\x04#42000Unknown database \'_be61cf5335d3ad96\'")
      packet_header = b'-\x00\x00\x02'
      btrl = 45
      btrh = 0
      packet_number = 2
      bytes_to_read = 45
      recv_data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      packet = <pymysql.protocol.MysqlPacket object at 0x7260c4c024d0>
  File "env/lib/python3.10/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7260c4c024d0>
      errno = 1049
  File "env/lib/python3.10/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b"\xff\x19\x04#42000Unknown database '_be61cf5335d3ad96'"
      errno = 1049
      errval = "Unknown database '_be61cf5335d3ad96'"
      errorclass = <class 'pymysql.err.OperationalError'>
pymysql.err.OperationalError: (1049, "Unknown database '_be61cf5335d3ad96'")
